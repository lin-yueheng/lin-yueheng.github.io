---
title: SpringBoot
abbrlink: 344860877
date: 2022-12-15 11:41:56
cover: assets/Snipaste_2023-01-17_15-46-03.png
categories:
- [è®¡ç®—æœºç§‘å­¦, Java, é›¶åŸºç¡€å­¦Javaè¯­è¨€-æµ™æ±Ÿå¤§å­¦-ç¿æº]
tags:
---

<h1 align="center">SpringBoot</h1>

ç‚¹è§£è¦å­¦

- SpringæŠ€æœ¯æ˜¯JavaEEå¼€å‘çš„å¿…å¤‡æŠ€èƒ½ï¼Œä¼ä¸šå¼€å‘æŠ€æœ¯é€‰å‹å‘½ä¸­ç‡>90%

- ä¸“ä¸šè§’åº¦

ç”¨æ¥ç®€åŒ–å¼€å‘ï¼Œé™ä½ä¼ä¸šçº§å¼€å‘çš„å¤æ‚æ€§

æ¡†æ¶æ•´åˆï¼Œé«˜æ•ˆæ•´åˆå…¶ä»–æŠ€æœ¯ï¼Œä»¥æé«˜ä¼ä¸šçº§åº”ç”¨ç¨‹åºå¼€å‘ä¸è¿è¡Œæ•ˆç‡



- ç®€åŒ–å¼€å‘

IOC

AOP

- â€‹			äº‹åŠ¡å¤„ç†

æ¡†æ¶æ•´åˆ

- MyBaties
- mybatis-plus
- Struts
- Struts2
- Hibernate



æ€ä¹ˆå­¦ä¹ 



- å­¦ä¹ springæ¡†æ¶çš„è®¾è®¡æ€æƒ³
- å­¦ä¹ åŸºç¡€æ“ä½œï¼Œæ€è€ƒæ“ä½œä¸æ€æƒ³ä¹‹é—´çš„è”ç³»
- å­¦ä¹ æ¡ˆä¾‹ï¼Œç†Ÿç»ƒåº”ç”¨æ“ä½œçš„åŒæ—¶ï¼Œä½“éªŒæ€æƒ³





åˆè¯†spring



äº†è§£springå®¶æ—(Springå…¨å®¶æ¡¶)

å‘å±•å²(Spring 5.0)



# spring frameworkç³»ç»Ÿæ¶æ„

-  Spring Frameworkæ˜¯springç”Ÿæ€åœˆä¸­æœ€åŸºç¡€çš„é¡¹ç›®ï¼Œæ˜¯å…¶ä»–é¡¹ç›®çš„æ ¹åŸºã€‚

(1)æ ¸å¿ƒå±‚

- Core Containerï¼šæ ¸å¿ƒå®¹å™¨ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯springæœ€æ ¸å¿ƒçš„æ¨¡å—ï¼Œå…¶ä»–çš„éƒ½éœ€è¦ä¾èµ–è¯¥æ¨¡å—ã€‚

(2)AOPå±‚

- AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ƒä¾èµ–çš„æ˜¯æ ¸å¿ƒå±‚å®¹å™¨ï¼Œç›®çš„æ˜¯==åœ¨ä¸æ”¹å˜åŸæœ‰ä»£ç çš„å‰æä¸‹å¯¹å…¶è¿›è¡ŒåŠŸèƒ½çš„å¢åŠ ã€‚

(3)Aspects:AOPæ˜¯æ€æƒ³ï¼ŒAspectsæ˜¯å¯¹å…¶AOPæ€æƒ³çš„å…·ä½“å®ç°

(3)æ•°æ®å±‚

- Data Access:æ•°æ®è®¿é—®å±‚ï¼ŒSpringå…¨å®¶æ¡¶ä¸­æœ‰å¯¹æ•°æ®è®¿é—®çš„å…·ä½“å®ç°æŠ€æœ¯
- Data Integration:æ•°æ®é›†æˆï¼ŒSpringæ”¯æŒæ•´åˆå…¶ä»–çš„æ•°æ®å±‚è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚Mybatis
- Transaction:äº‹åŠ¡ï¼Œspringä¸­äº‹åŠ¡ç®¡ç†æ˜¯spring AOPçš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œæ˜¯ä¸€ä¸ªé‡ç‚¹ã€‚

(4)Webå±‚

- è¿™ä¸€å±‚çš„å†…å®¹å°†åœ¨springMVCæ¡†æ¶ä¸­å…·ä½“å­¦ä¹ 

(5)Testå±‚

- Springä¸»è¦æ•´åˆäº†Junitæ¥å®Œæˆå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•



Spirngæ ¸å¿ƒæ¦‚å¿µå†…å®¹ä¸­ä¸»è¦åŒ…å«IOC/DIã€IOCå®¹å™¨å’ŒBeanã€‚

(1)ä¸šåŠ¡å±‚éœ€è¦è°ƒç”¨æ•°æ®å±‚çš„æ–¹æ³•ï¼Œå°±éœ€è¦åœ¨ä¸šåŠ¡å±‚newæ•°æ®å±‚çš„å¯¹è±¡

(2)å¦‚æœæ•°æ®å±‚çš„å®ç°ç±»å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆä¸šåŠ¡å±‚çš„ä»£ç ä¹Ÿéœ€è¦è·Ÿç€æ”¹å˜ï¼Œå‘ç”Ÿå˜æ›´åï¼Œéƒ½éœ€è¦è¿›è¡Œç¼–è¯‘æ‰“åŒ…å’Œé‡éƒ¨ç½²

(3)æ‰€ä»¥ä»£ç åœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼š==è€¦åˆåº¦åé«˜==

å¦‚ä½•è§£å†³å‘¢

![1629724206002](java-SSM.assets/1629724206002.png)

æ‰€ä»¥ç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œä¸šåŠ¡å±‚ä¸æƒ³newå¯¹è±¡ï¼Œè¿è¡Œçš„æ—¶å€™åˆéœ€è¦è¿™ä¸ªå¯¹è±¡ï¼Œè¯¥å’‹åŠå‘¢

é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼ŒSpringå°±æå‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ:

- å°±æ˜¯åœ¨é€‚ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œåœ¨ç¨‹åºä¸­ä¸è¦ä¸»åŠ¨ä½¿ç”¨newäº§ç”Ÿå¯¹è±¡ï¼Œè½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›å¯¹è±¡

è¿™ç§å®ç°çš„æ€æƒ³å°±æ˜¯springçš„ä¸€ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µ



## 1 IOCã€IOCå®¹å™¨ã€Branã€DI

1. IOD(Inversion of Control)æ§åˆ¶åè½¬

(1)ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬ï¼Ÿ

- ä½¿ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œç”±ä¸»åŠ¨newäº§ç”Ÿå¯¹è±¡è½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›äº†å¯¹è±¡ï¼Œæ­¤è¿‡ç¨‹å°±æ˜¯å¯¹è±¡åˆ›å»ºæ§åˆ¶æƒç”±ç¨‹åºè½¬ç§»åˆ°å¤–éƒ¨ï¼Œè¿™ä¸ªæ€æƒ³å°±æ˜¯æ§åˆ¶åè½¬ã€‚

(2)Springå’ŒIOCä¹‹é—´çš„å…³ç³»æ˜¯å•¥ï¼Ÿ

- SpringæŠ€æœ¯å¯¹IOCæ€æƒ³è¿›è¡Œäº†å®ç°
- springæä¾›äº†ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸ºIOCå®¹å™¨ï¼Œç”¨æ¥å……å½“IOCæ€æƒ³ä¸­çš„â€œå¤–éƒ¨â€
- IOCæ€æƒ³ä¸­çš„åˆ«äºº[å¤–éƒ¨]æŒ‡çš„å°±æ˜¯springä¸­çš„IOCå®¹å™¨

(3)IOCå®¹å™¨çš„ä½œç”¨ä»¥åŠå†…éƒ¨å­˜æ”¾çš„æ˜¯ä»€ä¹ˆï¼Ÿ

- IOCå®¹å™¨è´Ÿè´£çš„å°±æ˜¯å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œå…¶ä¸­å°±åŒ…å«äº†æ•°æ®å±‚ä¸šåŠ¡å±‚çš„å¯¹è±¡ã€‚
- åˆ«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡åœ¨IOCå®¹å™¨ä¸­ç»Ÿç§°ä¸ºBean
- IOCå®¹å™¨ä¸­æ”¾çš„å°±æ˜¯ä¸€ä¸ªä¸ªçš„Beanå¯¹è±¡

(4)å½“IOCå®¹å™¨ä¸­åˆ›å»ºå¥½serviceå’Œdaoå¯¹è±¡ä¹‹åï¼Œç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—?

- ä¸è¡Œï¼Œå› ä¸ºserviceè¿è¡Œå¾å¨…ä»¥æ¥daoå¯¹è±¡
- IOCå®¹å™¨ä¸­è™½ç„¶serviceå’Œdaoå¯¹è±¡æ²¡æœ‰ä»»ä½•å…³ç³»
- éœ€è¦æŠŠdaoå¯¹è±¡äº¤ç»™serviceï¼Œä¹Ÿå°±æ˜¯è¯´è¦ç»‘å®šserviceå’Œdaoå¯¹è±¡ä¹‹é—´çš„å…³ç³»



åƒè¿™ç§åœ¨å®¹å™¨ä¸­å»ºç«‹å¯¹åƒä¸å¯¹è±¡ä¹‹é—´çš„ç»‘å®šå…³ç³»å°±è¦ç”¨åˆ°DIï¼š

2. DIä¾èµ–æ³¨å…¥

(1)ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥å‘¢ï¼Ÿ

- åœ¨å®¹å™¨ä¸­å»ºç«‹beanä¸beanä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¸ºä¾èµ–æ³¨å…¥

ä¸šåŠ¡å±‚è¦ç”¨åˆ°æ•°æ®å±‚çš„ç±»å¯¹è±¡ï¼Œä»¥å‰éƒ½æ˜¯è‡ªå·±newçš„

ç°åœ¨è¦é åˆ«äºº[å¤–éƒ¨æŒ‡çš„å°±æ˜¯IOCå®¹å™¨]æ¥æ³¨å…¥è¿›æ¥

(2)IOCå®¹å™¨ä¸­å“ªä¸€äº›beanä¹‹é—´éœ€è¦å»ºç«‹ä¾èµ–å…³ç³»å‘¢ï¼Ÿ

- è¿™ä¸ªéœ€è¦ç¨‹åºå‘˜æ ¹æ®ä¸šåŠ¡éœ€æ±‚æå‰å»ºç«‹å¥½å…³ç³»ï¼Œå¦‚ä¸šåŠ¡å±‚éœ€è¦ä¾èµ–æ•°æ®å±‚ï¼Œserviceå°±è¦å’Œdaoå»ºç«‹ä¾èµ–å…³ç³»



### IOCå…¥é—¨æ¡ˆä¾‹çš„å®ç°

**æ·»åŠ æ¡ˆä¾‹ä¸­éœ€è¦çš„ç±»ï¼š**

```java
public interface BookDao {
    public void save();
}
public class BookDaoImpl implements BookDao {
    public void save() {
        System.out.println("book dao save ...");
    }
}
public interface BookService {
    public void save();
}
public class BookServiceImpl implements BookService {
    private BookDao bookDao = new BookDaoImpl();
    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
    }
}
```

åœ¨resourceä¸‹æ·»åŠ springé…ç½®æ–‡ä»¶applicationContext.xmlï¼Œå¹¶å®Œæˆbeançš„é…ç½®

```Java
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
 
    <!--beanæ ‡ç­¾æ ‡ç¤ºé…ç½®bean
    	idå±æ€§æ ‡ç¤ºç»™beanèµ·åå­—
    	classå±æ€§è¡¨ç¤ºç»™beanå®šä¹‰ç±»å‹
	-->
	<bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl"/>
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl"/>

</beans>
```

è·å–IOCå®¹å™¨ğŸš¿

```java
public class App {
    public static void main(String[] args) {
        //è·å–IOCå®¹å™¨
        ApplicationContext context=new ClassPathXmlApplicationContext("applicationContext.xml");

        
        BookDao bookDao = (BookDao) context.getBean("bookDao");
        BookService bookService= (BookService) context.getBean("bookService");
        bookDao.save();
        bookService.save();
    }
}
```





DIå…¥é—¨æ¡ˆä¾‹

> éœ€æ±‚ï¼šåŸºäºIOCå…¥é—¨æ¡ˆä¾‹ï¼Œåœ¨BookServiceImplç±»ä¸­åˆ é™¤newå¯¹è±¡çš„æ–¹å¼ï¼Œä½¿ç”¨Springçš„DIå®ŒæˆDaoå±‚çš„æ³¨å…¥
>
> 1.åˆ é™¤ä¸šåŠ¡å±‚ä¸­ä½¿ç”¨newçš„æ–¹å¼åˆ›å»ºçš„daoå¯¹è±¡
>
> 2.åœ¨ä¸šåŠ¡å±‚æä¾›BookDaoçš„setteræ–¹æ³•
>
> 3.åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–æ³¨å…¥çš„é…ç½®(property)
>
> 4.è¿è¡Œç¨‹åºè°ƒç”¨æ–¹æ³•



### IOCç›¸å…³çš„å†…å®¹

beanåŸºç¡€é…ç½®

```xml
<bean id="" class=""/>
```

beançš„nameå±æ€§

é…ç½®åˆ«å

```XML
<bean id="" class="" name=""/>    ä»¥ç©ºæ ¼or,or;åˆ†éš”å¼€æ¥ï¼Œä½œç”¨æ•ˆæœè·Ÿidä¸€æ ·
```



## 2 beanä½œç”¨èŒƒå›´scopeé…ç½®

```
scope="prototype"  è¿™ä¸ªå°±æ˜¯éå•ä¾‹çš„
scope="singleton"  è¿™ä¸ªå°±æ˜¯å•ä¾‹çš„
```

åœ¨é»˜è®¤çš„æƒ…å†µä¹‹ä¸‹ï¼Œspringåˆ›å»ºçš„beanå¯¹è±¡éƒ½æ˜¯å•ä¾‹çš„



### scopeä½¿ç”¨çš„æ„Ÿå—

ä¸ºä»€ä¹ˆbeané»˜è®¤çš„æƒ…å†µä¹‹ä¸‹éƒ½æ˜¯ä¸ºå•ä¾‹çš„å‘¢ï¼Ÿ

- beanä¸ºå•ä¾‹çš„æ„æ€å°±æ˜¯è¯´åœ¨springçš„IOCå®¹å™¨ä¸­åªä¼šæœ‰è¯¥ç±»çš„ä¸€ä¸ªå¯¹è±¡

- beanå¯¹è±¡åªæœ‰ä¸€ä¸ªå°±é¿å…äº†å¯¹è±¡çš„é¢‘ç¹åˆ›å»ºè·Ÿé”€æ¯ï¼Œè¾¾åˆ°äº†beanå¯¹è±¡çš„å¤ç”¨ï¼Œæ€§èƒ½é«˜ã€‚

beanåœ¨å®¹å™¨ä¸­æ˜¯å•ä¾‹çš„è¯ï¼Œä¼šä¸ä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ

- å¦‚æœå¯¹è±¡æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œå³è¯¥å¯¹è±¡ä¸­æœ‰æˆå‘˜å˜é‡ç”¨æ¥å­˜å‚¨æ•°æ®çš„ã€‚å› ä¸ºæ‰€æœ‰çš„è¯·æ±‚å…±ç”¨ä¸€ä¸ªbeanå¯¹è±¡ï¼Œæ‰€ä»¥ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚
- å¦‚æœå¯¹è±¡æ˜¯æ— çŠ¶æ€çš„ï¼Œå³è¯¥å¯¹è±¡æ²¡æœ‰æˆå‘˜å˜é‡æ²¡æœ‰è¿›è¡Œæ•°æ®å­˜å‚¨çš„ï¼Œå› ä¸ºæ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡åœ¨æ–¹æ³•è°ƒç”¨ä¹‹åä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥ä¸ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜



å“ªäº›beanå¯¹è±¡é€‚åˆäº¤ç»™å®¹å™¨æ¥è¿›è¡Œç®¡ç†

- è¡¨ç°å±‚å¯¹è±¡
- ä¸šåŠ¡å±‚å¯¹è±¡
- æ•°æ®å±‚å¯¹è±¡
- å·¥å…·å¯¹è±¡



å“ªäº›beanå¯¹è±¡ä¸é€‚åˆäº¤ç»™å®¹å™¨æ¥è¿›è¡Œç®¡ç†

- å°è£…æ˜¯é‡Œçš„åŸŸå¯¹è±¡ï¼Œå› ä¸ºä¼šå¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥ä¸é€‚åˆã€‚



beanåŸºç¡€é…ç½®çš„å°ç»“

å…³äºbeançš„åŸºç¡€é…ç½®ä¸­

```XML
<bean id="beançš„å”¯ä¸€æ ‡è¯†"
class="beançš„ç±»å…¨å"
scope="beançš„ä½œç”¨èŒƒå›´,æœ‰singleton(é»˜è®¤)å’Œpropertype"
name="ä¸ºweanå–å¾—åˆ«å"
">
```



## 3 beançš„å®ä¾‹åŒ–

å®ä¾‹åŒ–çš„ä¸‰ç§æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å’Œå®ä¾‹å·¥å‚

beanæœ¬è´¨ä¸Šå°±æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡åœ¨newçš„æ—¶å€™ä¼šä½¿ç”¨æ„é€ æ–¹æ³•å®Œæˆï¼Œé‚£ä¹ˆåˆ›å»ºbeanä¹Ÿæ˜¯ä½¿ç”¨æ„é€ æ–¹æ³•æ¥å®Œæˆçš„ã€‚





å°†BookDaoImplä¸­çš„æ„é€ æ–¹æ³•è®¾ç½®ä¸ºprivate

å¹¶ä¸”åœ¨é‡Œé¢æ‰“å°ä¸€å¥è¯æ¥æµ‹è¯•

èƒ½æ‰§è¡ŒæˆåŠŸï¼Œè¯´æ˜å†…éƒ¨èµ°çš„ä¾æ—§æ˜¯æ„é€ å‡½æ•°ï¼Œèƒ½å¤Ÿè®¿é—®ç±»ä¸­çš„ç§æœ‰æ„é€ æ–¹æ³•ï¼Œæ˜¾è€Œæ˜“è§springåº•å±‚ç”¨çš„å°±æ˜¯åå°„ã€‚

```java
public class BookDaoImpl implements BookDao {
    private BookDaoImpl() {
        System.out.println("book dao constructor is running ....");
    }
    public void save() {
        System.out.println("book dao save ...");
    }

}	
```



æ„é€ å‡½æ•°ä¸­æ·»åŠ ä¸€ä¸ªå‚æ•°æµ‹è¯•

ç¨‹åºä¼šæŠ¥é”™ï¼Œè¯´æ˜springåº•å±‚ä½¿ç”¨çš„æ˜¯ç±»çš„æ— å‚æ„é€ æ–¹æ³•

```java
public class BookDaoImpl implements BookDao {
    private BookDaoImpl(int i) {
        System.out.println("book dao constructor is running ....");
    }
    public void save() {
        System.out.println("book dao save ...");
    }

}
```



åˆ†æspringçš„é”™è¯¯ä¿¡æ¯

springçš„æŠ¥é”™ä¿¡æ¯æ¥å­¦ä¸€å­¦å¦‚é˜…è¯»ã€‚

- é”™è¯¯ä¿¡æ¯ä»ä¸‹å¾€ä¸Šæ¥æŸ¥çœ‹ï¼Œå› ä¸ºä¸Šé¢çš„é”™è¯¯å¤§éƒ½æ˜¯è¥¿é¢é”™è¯¯çš„ä¸€ä¸ªåŒ…è£…ï¼Œæœ€æ ¸å¿ƒé”™è¯¯æ˜¯åœ¨æœ€ä¸‹é¢



### é™æ€å·¥å‚å®ä¾‹åŒ–

(1)å‡†å¤‡ä¸€ä¸ªOrderDaoå’ŒOrderDaoImplç±»

```java
public interface OrderDao {
    public void save();
}

public class OrderDaoImpl implements OrderDao {
    public void save() {
        System.out.println("order dao save ...");
    }
}
```

(2)åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»OrderDaoFactoryå¹¶æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•

```java
//é™æ€å·¥å‚åˆ›å»ºå¯¹è±¡
public class OrderDaoFactory {
    public static OrderDao getOrderDao(){
        return new OrderDaoImpl();
    }
}
```

(3)ç¼–å†™AppForInstanceOrderè¿è¡Œç±»ï¼Œåœ¨ç±»ä¸­åˆ›å»ºå·¥å‚æ¥è·å–å¯¹è±¡

```java
public class AppForInstanceOrder {
    public static void main(String[] args) {
        //é€šè¿‡é™æ€å·¥å‚åˆ›å»ºå¯¹è±¡
        OrderDao orderDao = OrderDaoFactory.getOrderDao();
        orderDao.save();
    }
}
```



(1)äº¤ç»™springæ¥è¿›è¡Œç®¡ç†

```xml
<bean id="orderDao" class="com.itheima.factory.OrderDaoFactory" factory-method="getOrderDao"/>
```

(2)åœ¨AppForInstanceOrderè¿è¡Œç±»ï¼Œä½¿ç”¨ä»IOCå®¹å™¨ä¸­è·å–beançš„æ–¹æ³•è¿›è¡Œè¿è¡Œæµ‹è¯•

```java
public class AppForInstanceOrder {
    public static void main(String[] args) {
        ApplicationContext ctx=new ClassPathxmlApplicationContext("applicationContext.xml");
        
        
        
        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");

        OrderDao orderDao = (OrderDao) ctx.getBean("orderDao");

        orderDao.save();

    }
}
```

- é™æ€å·¥å‚çš„æ–¹å¼åè€Œæ›´åŠ å¤æ‚

ä¸»è¦çš„åŸå› å°±æ˜¯ï¼š

- åœ¨å·¥å‚çš„é™æ€æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é™¤äº†newå¯¹è±¡ä¹‹å¤–è¿˜å¯ä»¥åšå…¶ä»–çš„ä¸€äº›ä¸šåŠ¡æ“ä½œï¼Œè¿™äº›æ“ä½œå¿…ä¸å¯å°‘ï¼Œå¦‚ï¼š

```java
public class OrderDaoFactory {
    public static OrderDao getOrderDao(){
        System.out.println("factory setup....");//æ¨¡æ‹Ÿå¿…è¦çš„ä¸šåŠ¡æ“ä½œ
        return new OrderDaoImpl();
    }
}
```

==é™æ€å·¥å‚ä»¥äº†è§£ä¸ºä¸»==



å®ä¾‹åŒ–å·¥å‚ä¸FactoryBean

å‰é¢çš„ä¸‰ä¸ªç±»æ“¦ä¸å¤šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªè¦æŠŠå…¶ä¸­çš„é™æ€æ–¹æ³•æ”¹ç¼–æˆä¸ºæ™®é€šçš„æ–¹æ³•å°±è¡Œäº†

```java
public class AppForInstanceUser {
    public static void main(String[] args) {
        //åˆ›å»ºå®ä¾‹å·¥å‚å¯¹è±¡
        UserDaoFactory userDaoFactory = new UserDaoFactory();
        //é€šè¿‡å®ä¾‹å·¥å‚å¯¹è±¡åˆ›å»ºå¯¹è±¡
        UserDao userDao = userDaoFactory.getUserDao();
        userDao.save();
}
```

æ¥ä¸‹æ¥å°±æ˜¯äº¤ç»™springæ¥ç®¡ç†



```xml
<bean id="userFactory" calss="com.ityueheng.foctory.UserDaoFactory"/>
<bean id="userDao" factory-method="getUserDao" factory-bean="UserFactory"/> 
```



å®ä¾‹åŒ–å·¥å‚è¿è¡Œçš„é¡ºåºå°±æ˜¯ï¼š

- åˆ›å»ºå®ä¾‹åŒ–å·¥å‚å¯¹è±¡ï¼Œå¯¹åº”çš„ç¬¬ä¸€è¡Œé…ç½®

- è°ƒç”¨å¯¹è±¡ä¸­çš„æ–¹æ³•æ¥åˆ›å»ºbeanï¼Œå¯¹åº”çš„æ˜¯ç¬¬äºŒè¡Œé…ç½®

factory-beanï¼šå·¥å‚çš„å®ä¾‹åŒ–å¯¹è±¡

factory-methodï¼šå·¥å‚å¯¹è±¡ä¸­çš„å…·ä½“åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•åã€‚



```java
public class AppForInstanceUser {
    public static void main(String[] args) {
        ApplicationContext ctx = new 
            ClassPathXmlApplicationContext("applicationContext.xml");
        UserDao userDao = (UserDao) ctx.getBean("userDao");
        userDao.save();
    }
}
```





FactoryBeançš„ä½¿ç”¨

å…·ä½“çš„ä½¿ç”¨æ­¥éª¤ä¸ºï¼š

1ï¼‰åˆ›å»ºä¸€ä¸ªUserDaoFactoryBeançš„ç±»ï¼Œå®ç°FactoryBeanæ¥å£ï¼Œé‡å†™æ¥å£ä¸­çš„æ–¹æ³•



```java
public class UserDaoFactoryBean implements FactoryBean<UserDao> {
    //ä»£æ›¿åŸå§‹å®ä¾‹å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•
    public UserDao getObject() throws Exception {
        return new UserDaoImpl();
    }
    //è¿”å›æ‰€åˆ›å»ºç±»çš„Classå¯¹è±¡
    public Class<?> getObjectType() {
        return UserDao.class;
    }
}
```



### beançš„ç”Ÿå‘½å‘¨æœŸ

* é¦–å…ˆç†è§£ä¸‹ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ?
  * ä»åˆ›å»ºåˆ°æ¶ˆäº¡çš„å®Œæ•´è¿‡ç¨‹,ä¾‹å¦‚äººä»å‡ºç”Ÿåˆ°æ­»äº¡çš„æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸã€‚
* beanç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆ?
  * beanå¯¹è±¡ä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä½“è¿‡ç¨‹ã€‚
* beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶æ˜¯ä»€ä¹ˆ?
  * åœ¨beanåˆ›å»ºååˆ°é”€æ¯å‰åšä¸€äº›äº‹æƒ…ã€‚

#### ç¯å¢ƒå‡†å¤‡

- åˆ›å»ºä¸€ä¸ªMavené¡¹ç›®
- pom.xmlæ·»åŠ ä¾èµ–
- resourcesä¸‹æ·»åŠ springçš„é…ç½®æ–‡ä»¶applicationContext.xml

(1)é¡¹ç›®ä¸­æ·»åŠ BookDaoã€BookDaoImplã€BookServiceå’ŒBookServiceImplç±»

```java
public interface BookDao {
    public void save();
}

public class BookDaoImpl implements BookDao {
    public void save() {
        System.out.println("book dao save ...");
    }
}

public interface BookService {
    public void save();
}

public class BookServiceImpl implements BookService{
    private BookDao bookDao;

    public void setBookDao(BookDao bookDao) {
        this.bookDao = bookDao;
    }

    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
    }
}
```

(2)resourcesä¸‹æä¾›springçš„é…ç½®æ–‡ä»¶

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl"/>
</beans>
```

(3)ç¼–å†™AppForLifeCycleè¿è¡Œç±»ï¼ŒåŠ è½½Springçš„IOCå®¹å™¨ï¼Œå¹¶ä»ä¸­è·å–å¯¹åº”çš„beanå¯¹è±¡

```java
public class AppForLifeCycle {
    public static void main( String[] args ) {
        ApplicationContext ctx = new 
        	ClassPathXmlApplicationContext("applicationContext.xml");
        BookDao bookDao = (BookDao) ctx.getBean("bookDao");
        bookDao.save();
    }
}
```

#### ç”Ÿå‘½å‘¨æœŸè®¾ç½®

åœ¨ä¸Šé¢è¿™ä¸ªç¯å¢ƒä¸­æ¥ä¸ºBookDaoæ·»åŠ ç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶æ–¹æ³•ï¼Œå…·ä½“çš„æ§åˆ¶æœ‰ä¸¤ä¸ªé˜¶æ®µ:

* beanåˆ›å»ºä¹‹åï¼Œæƒ³è¦æ·»åŠ å†…å®¹ï¼Œæ¯”å¦‚ç”¨æ¥åˆå§‹åŒ–éœ€è¦ç”¨åˆ°èµ„æº
* beané”€æ¯ä¹‹å‰ï¼Œæƒ³è¦æ·»åŠ å†…å®¹ï¼Œæ¯”å¦‚ç”¨æ¥é‡Šæ”¾ç”¨åˆ°çš„èµ„æº

##### æ­¥éª¤1:æ·»åŠ åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•

é’ˆå¯¹è¿™ä¸¤ä¸ªé˜¶æ®µï¼ŒBooDaoImplç±»ä¸­åˆ†åˆ«æ·»åŠ ä¸¤ä¸ªæ–¹æ³•ï¼Œ==æ–¹æ³•åä»»æ„==

```java
public class BookDaoImpl implements BookDao {
    public void save() {
        System.out.println("book dao save ...");
    }
    //è¡¨ç¤ºbeanåˆå§‹åŒ–å¯¹åº”çš„æ“ä½œ
    public void init(){
        System.out.println("init...");
    }
    //è¡¨ç¤ºbeané”€æ¯å‰å¯¹åº”çš„æ“ä½œ
    public void destory(){
        System.out.println("destory...");
    }
}
```

##### æ­¥éª¤2:é…ç½®ç”Ÿå‘½å‘¨æœŸ

åœ¨é…ç½®æ–‡ä»¶æ·»åŠ é…ç½®ï¼Œå¦‚ä¸‹:

```xml
<bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl" init-method="init" destroy-method="destory"/>
```

##### æ­¥éª¤3:è¿è¡Œç¨‹åº

è¿è¡ŒAppForLifeCycleæ‰“å°ç»“æœä¸º:

ä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œinitæ–¹æ³•æ‰§è¡Œäº†ï¼Œä½†æ˜¯destroyæ–¹æ³•å´æœªæ‰§è¡Œ

* Springçš„IOCå®¹å™¨æ˜¯è¿è¡Œåœ¨JVMä¸­
* è¿è¡Œmainæ–¹æ³•å,JVMå¯åŠ¨,SpringåŠ è½½é…ç½®æ–‡ä»¶ç”ŸæˆIOCå®¹å™¨,ä»å®¹å™¨è·å–beanå¯¹è±¡ï¼Œç„¶åè°ƒæ–¹æ³•æ‰§è¡Œ
* mainæ–¹æ³•æ‰§è¡Œå®Œåï¼ŒJVMé€€å‡ºï¼Œè¿™ä¸ªæ—¶å€™IOCå®¹å™¨ä¸­çš„beanè¿˜æ²¡æœ‰æ¥å¾—åŠé”€æ¯å°±å·²ç»ç»“æŸäº†
* æ‰€ä»¥æ²¡æœ‰è°ƒç”¨å¯¹åº”çš„destroyæ–¹æ³•

#### closeå…³é—­å®¹å™¨

* ApplicationContextä¸­æ²¡æœ‰closeæ–¹æ³•

* éœ€è¦å°†ApplicationContextæ›´æ¢æˆClassPathXmlApplicationContext

  ```java
  ClassPathXmlApplicationContext ctx = new 
      ClassPathXmlApplicationContext("applicationContext.xml");
  ```

* è°ƒç”¨ctxçš„close()æ–¹æ³•

  ```
  ctx.close();
  ```

#### æ³¨å†Œé’©å­å…³é—­å®¹å™¨

* åœ¨å®¹å™¨æœªå…³é—­ä¹‹å‰ï¼Œæå‰è®¾ç½®å¥½å›è°ƒå‡½æ•°ï¼Œè®©JVMåœ¨é€€å‡ºä¹‹å‰å›è°ƒæ­¤å‡½æ•°æ¥å…³é—­å®¹å™¨

* è°ƒç”¨ctxçš„registerShutdownHook()æ–¹æ³•

  ```
  ctx.registerShutdownHook();
  ```

  **æ³¨æ„:**registerShutdownHookåœ¨ApplicationContextä¸­ä¹Ÿæ²¡æœ‰

* è¿è¡Œåï¼ŒæŸ¥è¯¢æ‰“å°ç»“æœ


ç›¸åŒç‚¹:è¿™ä¸¤ç§éƒ½èƒ½ç”¨æ¥å…³é—­å®¹å™¨

ä¸åŒç‚¹:close()æ˜¯åœ¨è°ƒç”¨çš„æ—¶å€™å…³é—­ï¼ŒregisterShutdownHook()æ˜¯åœ¨JVMé€€å‡ºå‰è°ƒç”¨å…³é—­ã€‚

åˆ†æä¸Šé¢çš„å®ç°è¿‡ç¨‹ï¼Œä¼šå‘ç°æ·»åŠ åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ï¼Œå³éœ€è¦ç¼–ç ä¹Ÿéœ€è¦é…ç½®ï¼Œå®ç°èµ·æ¥æ­¥éª¤æ¯”è¾ƒå¤šä¹Ÿæ¯”è¾ƒä¹±ã€‚

Springæä¾›äº†ä¸¤ä¸ªæ¥å£æ¥å®Œæˆç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶ï¼Œå¥½å¤„æ˜¯å¯ä»¥ä¸ç”¨å†è¿›è¡Œé…ç½®`init-method`å’Œ`destroy-method`

æ¥ä¸‹æ¥åœ¨BookServiceImplå®Œæˆè¿™ä¸¤ä¸ªæ¥å£çš„ä½¿ç”¨:

ä¿®æ”¹BookServiceImplç±»ï¼Œæ·»åŠ ä¸¤ä¸ªæ¥å£`InitializingBean`ï¼Œ `DisposableBean`å¹¶å®ç°æ¥å£ä¸­çš„ä¸¤ä¸ªæ–¹æ³•`afterPropertiesSet`å’Œ`destroy`

```java
public class BookServiceImpl implements BookService, InitializingBean, DisposableBean {
    private BookDao bookDao;
    public void setBookDao(BookDao bookDao) {
        this.bookDao = bookDao;
    }
    public void save() {
        System.out.println("book service save ...");
        bookDao.save(); 
    }
    public void destroy() throws Exception {
        System.out.println("service destroy");
    }
    public void afterPropertiesSet() throws Exception {
        System.out.println("service init");
    }
}
```

**å°ç»†èŠ‚**

* å¯¹äºInitializingBeanæ¥å£ä¸­çš„afterPropertiesSetæ–¹æ³•ï¼Œç¿»è¯‘è¿‡æ¥ä¸º`å±æ€§è®¾ç½®ä¹‹å`ã€‚

* å¯¹äºBookServiceImplæ¥è¯´ï¼ŒbookDaoæ˜¯å®ƒçš„ä¸€ä¸ªå±æ€§

* setBookDaoæ–¹æ³•æ˜¯Springçš„IOCå®¹å™¨ä¸ºå…¶æ³¨å…¥å±æ€§çš„æ–¹æ³•

  * ä»æ–¹æ³•ååˆ†æï¼ŒçŒœæƒ³åº”è¯¥æ˜¯setBookDaoæ–¹æ³•å…ˆæ‰§è¡Œ

  * éªŒè¯æ€è·¯ï¼Œåœ¨setBookDaoæ–¹æ³•ä¸­æ·»åŠ ä¸€å¥è¯

    ```java
    public void setBookDao(BookDao bookDao) {
            System.out.println("set .....");
            this.bookDao = bookDao;
        }
    
    ```

  * é‡æ–°è¿è¡ŒAppForLifeCycleï¼Œæ‰“å°ç»“æœå¦‚ä¸‹:


#### beanç”Ÿå‘½å‘¨æœŸå°ç»“

(1)å…³äºSpringä¸­å¯¹beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶æä¾›äº†ä¸¤ç§æ–¹å¼:

* åœ¨é…ç½®æ–‡ä»¶ä¸­çš„beanæ ‡ç­¾ä¸­æ·»åŠ `init-method`å’Œ`destroy-method`å±æ€§
* ç±»å®ç°`InitializingBean`ä¸`DisposableBean`æ¥å£

(2)å¯¹äºbeançš„ç”Ÿå‘½å‘¨æœŸæ§åˆ¶åœ¨beançš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­æ‰€å¤„çš„ä½ç½®å¦‚ä¸‹:

* åˆå§‹åŒ–å®¹å™¨
  * 1.åˆ›å»ºå¯¹è±¡(å†…å­˜åˆ†é…)
  * 2.æ‰§è¡Œæ„é€ æ–¹æ³•
  * 3.æ‰§è¡Œå±æ€§æ³¨å…¥(setæ“ä½œ)
  * ==4.æ‰§è¡Œbeanåˆå§‹åŒ–æ–¹æ³•==
* ä½¿ç”¨bean
  * 1.æ‰§è¡Œä¸šåŠ¡æ“ä½œ
* å…³é—­/é”€æ¯å®¹å™¨
  * ==1.æ‰§è¡Œbeané”€æ¯æ–¹æ³•==

(3)å…³é—­å®¹å™¨çš„ä¸¤ç§æ–¹å¼:

* ConfigurableApplicationContextæ˜¯ApplicationContextçš„å­ç±»
  * close()æ–¹æ³•
  * registerShutdownHook()æ–¹æ³•



## 4 DIç›¸å…³å†…å®¹



### Setteræ³¨å…¥

åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§ï¼Œå¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³•

```JAVA
public class BookServiceImpl implements BookService {
    private BookDao bookDao;
    public void setBookDao(BookDao bookDao) {
        this.bookDao = bookDao;
    }
}
```

é…ç½®ä¸­ä½¿ç”¨propertyæ ‡ç­¾refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡

```xml
<bean id="bookService" class="com.itheima.service.impl.BookServiceImpl">
	<property name="bookDao" ref="bookDao"/>
</bean>

<bean id="bookDao" class="com.itheima.dao.imipl.BookDaoImpl"/>
```



```java
public interface BookDao {
    public void save();
}

public class BookDaoImpl implements BookDao {
    public void save() {
        System.out.println("book dao save ...");
    }
}
public interface UserDao {
    public void save();
}
public class UserDaoImpl implements UserDao {
    public void save() {
        System.out.println("user dao save ...");
    }
}

public interface BookService {
    public void save();
}

public class BookServiceImpl implements BookService{
    private BookDao bookDao;

    public void setBookDao(BookDao bookDao) {
        this.bookDao = bookDao;
    }

    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
    }
}
```



å¼•ç”¨ç±»å‹çš„æ³¨å…¥

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl"/>
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl">
        <property name="bookDao" ref="bookDao"/>
    </bean>
</beans>
```



setteræ–¹å¼çš„æ³¨å…¥

å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹çš„ä½¿ç”¨çš„æ˜¯<property name="" ref=""/>

å¯¹äºç®€å•æ•°æ®ç±»å‹çš„ä½¿ç”¨å°±æ˜¯<property name="" value=""/>



## 5 æ„é€ å™¨çš„æ³¨å…¥

æ„é€ å™¨æ³¨å…¥ä¹Ÿå°±æ˜¯æ„é€ æ–¹æ³•çš„æ³¨å…¥

```java
public interface BookDao {
    public void save();
}

public class BookDaoImpl implements BookDao {
    
    private String databaseName;
    private int connectionNum;
    
    public void save() {
        System.out.println("book dao save ...");
    }
}
public interface UserDao {
    public void save();
}
public class UserDaoImpl implements UserDao {
    public void save() {
        System.out.println("user dao save ...");
    }
}

public interface BookService {
    public void save();
}

public class BookServiceImpl implements BookService{
    private BookDao bookDao;

    public void setBookDao(BookDao bookDao) {
        this.bookDao = bookDao;
    }

    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
    }
}
```



æ„é€ å™¨æ³¨å…¥å¼•ç”¨æ•°æ®ç±»å‹

> éœ€æ±‚ï¼šå°†BookServiceImplç±»ä¸­çš„bookDaoä¿®æ”¹æˆä¸ºä½¿ç”¨æ„é€ å™¨çš„æ–¹å¼æ³¨å…¥
>
> 1. å°†bookDaoä¸­çš„setteræ–¹æ³•åˆ é™¤
> 2. æ·»åŠ å¸¦æœ‰bookDaoå‚æ•°çš„æ„é€ æ–¹æ³•
> 3. åœ¨applicationContext.xmlä¸­è¿›è¡Œé…ç½®



```java
public class BookServiceImpl implements BookService{
    private BookDao bookDao;

    public BookServiceImpl(BookDao bookDao) {
        this.bookDao = bookDao;
    }

    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
    }
}
```



```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.ityueheng.dao.impl.BookDaoImpl"/>
    <bean id="bookService" class="com.ityueheng.service.impl.BookServiceImpl">
       é‡ç‚¹ï¼š <constructor-arg name="bookDao" ref="bookDao"/>
    </bean>
</beans>
```



æ ‡ç­¾<constructor-arg>ä¸­

- nameå±æ€§å¯¹åº”çš„å€¼ä¸ºæ„é€ å‡½æ•°ä¸­çš„æ–¹æ³•å½¢å‚çš„å‚æ•°åï¼Œå¿…é¡»è¦ä¿æŒä¸€è‡´
- refå±æ€§æŒ‡å‘çš„æ˜¯springçš„IOCå®¹å™¨ä¸­çš„å…¶ä»–beanå¯¹è±¡



æ„é€ å™¨ä¸­æ³¨å…¥å¤šä¸ªå¼•ç”¨çš„æ•°æ®ç±»å‹

> éœ€æ±‚ï¼šåœ¨BookServiceImplä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥å¤šä¸ªå¼•ç”¨æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚userDao
>
> 1. å£°æ˜userDaoå±æ€§
>
> 2. ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰bookDaoå’ŒuserDaoå‚æ•°çš„æ„é€ å‡½æ•°
> 3. åœ¨applicationContext.xmlä¸­é…ç½®æ³¨å…¥



1.**æä¾›å¤šä¸ªå±æ€§çš„æ„é€ å‡½æ•°**

```java
public class BookServiceImpl implements BookService{
    private BookDao bookDao;
    private UserDao userDao;

    public BookServiceImpl(BookDao bookDao,UserDao userDao) {
        this.bookDao = bookDao;
        this.userDao = userDao;
    }

    public void save() {
        System.out.println("book service save ...");
        bookDao.save();
        userDao.save();
    }
}
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl"/>
    <bean id="userDao" class="com.itheima.dao.impl.UserDaoImpl"/>
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl">
        <constructor-arg name="bookDao" ref="bookDao"/>
        <constructor-arg name="userDao" ref="userDao"/>
    </bean>
</beans>
```



#### æ„é€ å™¨æ³¨å…¥å¤šä¸ªç®€å•æ•°æ®ç±»å‹

> éœ€æ±‚:åœ¨BookDaoImplä¸­ï¼Œä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥databaseNameå’ŒconnectionNumä¸¤ä¸ªå‚æ•°ã€‚
>
> å‚è€ƒå¼•ç”¨æ•°æ®ç±»å‹çš„æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºå…·ä½“çš„æ­¥éª¤ä¸º:
>
> 1.æä¾›ä¸€ä¸ªåŒ…å«è¿™ä¸¤ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•
>
> 2.åœ¨applicationContext.xmlä¸­è¿›è¡Œæ³¨å…¥é…ç½®

##### æ­¥éª¤1:æ·»åŠ å¤šä¸ªç®€å•å±æ€§å¹¶æä¾›æ„é€ æ–¹æ³•

ä¿®æ”¹BookDaoImplç±»ï¼Œæ·»åŠ æ„é€ æ–¹æ³•

```java
public class BookDaoImpl implements BookDao {
    private String databaseName;
    private int connectionNum;

    public BookDaoImpl(String databaseName, int connectionNum) {
        this.databaseName = databaseName;
        this.connectionNum = connectionNum;
    }

    public void save() {
        System.out.println("book dao save ..."+databaseName+","+connectionNum);
    }
}
```

##### æ­¥éª¤2:é…ç½®å®Œæˆå¤šä¸ªå±æ€§æ„é€ å™¨æ³¨å…¥

åœ¨applicationContext.xmlä¸­è¿›è¡Œæ³¨å…¥é…ç½®

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl">
        <constructor-arg name="databaseName" value="mysql"/>
        <constructor-arg name="connectionNum" value="666"/>
    </bean>
    <bean id="userDao" class="com.itheima.dao.impl.UserDaoImpl"/>
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl">
        <constructor-arg name="bookDao" ref="bookDao"/>
        <constructor-arg name="userDao" ref="userDao"/>
    </bean>
</beans>
```

**è¯´æ˜:**è¿™ä¸¤ä¸ª`<contructor-arg>`çš„é…ç½®é¡ºåºå¯ä»¥ä»»æ„

##### æ­¥éª¤3:è¿è¡Œç¨‹åº

è¿è¡ŒAppForDIConstructorç±»ï¼ŒæŸ¥çœ‹ç»“æœ



ä¸Šé¢å·²ç»å®Œæˆäº†æ„é€ å‡½æ•°æ³¨å…¥çš„åŸºæœ¬ä½¿ç”¨ï¼Œä½†æ˜¯ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜:



* å½“æ„é€ å‡½æ•°ä¸­æ–¹æ³•çš„å‚æ•°åå‘ç”Ÿå˜åŒ–åï¼Œé…ç½®æ–‡ä»¶ä¸­çš„nameå±æ€§ä¹Ÿéœ€è¦è·Ÿç€å˜
* è¿™ä¸¤å—å­˜åœ¨ç´§è€¦åˆ



æ–¹å¼ä¸€ï¼šåˆ é™¤nameå±æ€§ï¼Œæ·»åŠ typeå±æ€§ï¼Œç„¶åæŒ‰ç…§ç±»å‹æ³¨å…¥

```xml
<bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl">
    <constructor-arg type="int" value="10"/>
    <constructor-arg type="java.lang.String" value="mysql"/>
</bean>
```

- è¿™ç§æ–¹å¼å¯ä»¥è§£å†³æ„é€ å‡½æ•°å½¢å‚åå‘ç”Ÿå˜åŒ–å¸¦æ¥çš„è€¦åˆæ€§
- ä½†æ˜¯å¦‚æœæ„é€ æ–¹æ³•å‚æ•°ä¸­æœ‰ç±»å‹ç›¸åŒçš„å‚æ•°ï¼Œè¿™ç§æ–¹å¼ä¸å¤ªé€‚åˆ

æ–¹å¼äºŒï¼šåˆ é™¤typeå±æ€§ï¼Œæ·»åŠ indexå±æ€§ï¼ŒæŒ‰ç…§ç´¢å¼•ä¸‹æ ‡æ³¨å…¥ï¼Œä¸‹æ ‡æ˜¯ä»é›¶å¼€å§‹çš„

```
<bean id="bookDaO class="com.ityueheng.dao.impl.BookDaoImpl">
  <constructor-arg index="0" value="100">
  <constructor-arg index="1" value="mysql">
  </bean>
```

- è¿™ç§æ–¹å¼å¯ä»¥è§£å†³å‚æ•°ç±»å‹é‡å¤é—®é¢˜
- ä½†æ˜¯å¦‚æœæ„é€ æ–¹æ³•å‚æ•°é¡ºåºå‘ç”Ÿæ”¹å˜ä¹‹åï¼Œè¿™ç§æ–¹å¼åˆå¸¦æ¥äº†è€¦åˆé—®é¢˜



è¯¥å¦‚ä½•é€‰æ‹©

1. å¼ºåˆ¶ä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥æœ‰æ¦‚ç‡ä¸è¿›è¡Œæ³¨å…¥å¯¼è‡´nullå¯¹è±¡å‡ºç°

å¼ºåˆ¶ä¾èµ–æŒ‡çš„æ˜¯å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶å€™å°±å¿…é¡»è¦æ³¨å…¥æŒ‡å®šçš„å¯¹è±¡

2. å¯é€‰ä¾èµ–ä½¿ç”¨setteræ³¨å…¥è¿›è¡Œï¼Œçµæ´»æ€§æ¯”è¾ƒå¼º

å¯é€‰ä¾èµ–æŒ‡çš„æ˜¯å¯¹è±¡åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­å¿…é¡»è¦æ³¨å…¥æŒ‡å®šçš„å‚æ•°

3. springæ¡†æ¶å€¡å¯¼ä½¿ç”¨æ„é€ å™¨ï¼Œç¬¬ä¸‰æ–¹æ¡†æ¶å†…éƒ¨å¤§å¤šæ•°é‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„å½¢å¼è¿›è¡Œæ•°æ®åˆå§‹åŒ–ï¼Œç›¸å¯¹æ¥è¯´æ¯”è¾ƒä¸¥è°¨
4. å¦‚æœæœ‰å¿…è¦å¯ä»¥ä¸¤è€…åŒæ—¶ä½¿ç”¨ï¼Œä½¿ç”¨æ„é€ å™¨æ³¨å…¥å®Œæˆå¼ºåˆ¶ä¾èµ–çš„æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥å®Œæˆå¯é€‰ä¾èµ–çš„æ³¨å…¥
5. å®é™…å¼€å‘è¿‡ç¨‹ä¸­è¿˜è¦æ ¹æ®å®é™…æƒ…å†µåˆ†æï¼Œå¦‚æœå—æ§å¯¹è±¡æ²¡æœ‰æä¾›setteræ–¹æ³•å°±å¿…é¡»è¦ä½¿ç”¨æ„é€ å™¨æ–¹æ³•æ³¨å…¥
6. è‡ªå·±å¼€å‘çš„æ¨¡å—ä¸­æ¨èä½¿ç”¨çš„æ˜¯setteræ³¨å…¥



setteræ³¨å…¥

- ç®€å•æ•°æ®ç±»å‹

```xml
<bean ...>
    <prperty name="" value=""/>
</bean>
```



- å¼•ç”¨æ•°æ®ç±»å‹

```xml
<bean ...>
  <property name="" ref=""/>
</bean>
```



æ„é€ å™¨æ³¨å…¥

- ç®€å•æ•°æ®ç±»å‹

```xml
<bean ...>
  <constructor-arg name="" index="" type="" value=""/>
  </bean>
```

- å¼•ç”¨æ•°æ®ç±»å‹

```xml
<bean ...>
     <constructor-arg name="" index="" type="" ref=""/>
</bean>
```

ä¾èµ–æ³¨å…¥çš„æ–¹å¼é€‰æ‹©ä¸Š

- å»ºè®®ä½¿ç”¨setteræ³¨å…¥
- ç¬¬ä¸‰æ–¹æŠ€æœ¯æ ¹æ®æƒ…å†µé€‰æ‹©



## 6 è‡ªåŠ¨é…ç½®

ä»€ä¹ˆæ˜¯ä¾èµ–è‡ªåŠ¨è£…é…ï¼Ÿ

- IOCå®¹å™¨æ ¹æ®beanæ‰€ä¾èµ–èµ„æºåœ¨å®¹å™¨ä¸­è‡ªåŠ¨æŸ¥æ‰¾å¹¶æ³¨å…¥åˆ°beanä¸­çš„è¿‡ç¨‹ç§°ä¸ºè‡ªåŠ¨è£…é…



è‡ªåŠ¨ç±»å‹è£…é…æœ‰å“ªäº›

- æŒ‰ç…§ç±»å‹ï¼ˆå¸¸ç”¨ï¼‰
- æŒ‰ç…§åç§°
- æŒ‰ç…§æ„é€ æ–¹æ³•
- ä¸å¯ç”¨è‡ªåŠ¨è£…é…



### å®Œæˆè‡ªåŠ¨è£…é…çš„é…ç½®

è‡ªåŠ¨è£…é…åªéœ€è¦ä¿®æ”¹applicationContext.xmlé…ç½®æ–‡ä»¶å³å¯ï¼›

1ï¼‰å°†<property>æ ‡ç­¾åˆ é™¤

2ï¼‰åœ¨<bean>æ ‡ç­¾ä¸­æ·»åŠ autowireå±æ€§



```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean class="com.itheima.dao.impl.BookDaoImpl"/>
    <!--autowireå±æ€§ï¼šå¼€å¯è‡ªåŠ¨è£…é…ï¼Œé€šå¸¸ä½¿ç”¨æŒ‰ç±»å‹è£…é…-->
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl" autowire="byType"/>

</beans>
```

æ³¨æ„äº‹é¡¹ï¼š

- éœ€è¦æ³¨å…¥å±æ€§çš„ç±»ä¸­å¯¹åº”çš„å±æ€§çš„setteræ–¹æ³•ä¸èƒ½çœç•¥
- è¢«æ³¨å…¥çš„å¯¹è±¡å¿…é¡»è¦è¢«springçš„IOCå®¹å™¨ç®¡ç†
- æŒ‰ç…§ç±»å‹åœ¨springçš„IOCå®¹å™¨ä¸­å¦‚æœæ‰¾åˆ°å¤šä¸ªå¯¹è±¡ï¼Œä¼šæŠ¥NoUniqueBeanDefinitionException

ä¸€ä¸ªç±»å‹åœ¨IOCä¸­æœ‰å¤šä¸ªå¯¹è±¡ï¼Œè¿˜æƒ³è¦æ³¨å…¥æˆåŠŸï¼Œè¿™ä¸ªæ—¶å€™å°±å¿…é¡»è¦æŒ‰ç…§åç§°æ¥è¿›è¡Œæ³¨å…¥ï¼Œé…ç½®æ–¹å¼ä¸ºï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean class="com.itheima.dao.impl.BookDaoImpl"/>
    <!--autowireå±æ€§ï¼šå¼€å¯è‡ªåŠ¨è£…é…ï¼Œé€šå¸¸ä½¿ç”¨æŒ‰ç±»å‹è£…é…-->
    <bean id="bookService" class="com.itheima.service.impl.BookServiceImpl" autowire="byName"/>

</beans>
```

æ³¨æ„äº‹é¡¹ï¼š

- æŒ‰ç…§åç§°æ³¨å…¥ä¸­çš„åç§°æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ



![image-20221203184643869](https://raw.githubusercontent.com/lin-yueheng/IMG_01/main/img/202212031846014.png)

bookDaoæ˜¯privateä¿®é¥°çš„ï¼Œå¤–éƒ¨ç±»æ— æ³•è¿›è¡Œè®¿é—®

å¯¹äºå¤–éƒ¨ç±»æ¥è¯´åªèƒ½è¿›è¡Œsetæ–¹æ³•è®¿é—®

å¯¹äºå¤–éƒ¨æ¥è¯´ï¼ŒsetBookDaoæ–¹æ³•åç§°ï¼Œsetåé¦–å­—æ¯å°å†™ä¹‹åå°±æ˜¯å…¶å±æ€§åç§°

- å¦‚æœæŒ‰ç…§åç§°å»æ‰¾å¯¹åº”çš„beanå¯¹è±¡ï¼Œæ‰¾ä¸åˆ°åˆ™æ³¨å…¥null
- å½“æŸä¸€ç§ç±»å‹åœ¨IOCå®¹å™¨ä¸­æœ‰å¤šä¸ªå¯¹è±¡ï¼ŒæŒ‰ç…§åç§°æ³¨å…¥åªæ‰¾å…¶æŒ‡å®šåç§°å¯¹åº”çš„beanå¯¹è±¡ï¼Œä¸ç„¶ä¼šæŠ¥é”™

ç”¨çš„æ›´å¤šçš„æ˜¯æŒ‰ç…§ç±»å‹æ³¨å…¥

1. è‡ªåŠ¨è£…é…ç”¨äºå¼•ç”¨ç±»å‹ä¾èµ–æ³¨å…¥ï¼Œä¸èƒ½å¯¹ç®€å•ç±»å‹è¿›è¡Œæ“ä½œ
2. ä½¿ç”¨æŒ‰ç±»å‹è£…é…æ—¶(byType)å¿…é¡»è¦ä¿è¯å®¹å™¨ä¸­çš„ç›¸åŒç±»å‹çš„beanå”¯ä¸€ï¼Œæ¨èä½¿ç”¨
3. ä½¿ç”¨æŒ‰ç…§åæ¬¡è£…é…æ—¶(byName)å¿…é¡»è¦ä¿éšœå®¹å™¨ä¸­å…·æœ‰æŒ‡å®šåç§°çš„beanï¼Œå› å˜é‡ä¸é…ç½®è€¦åˆï¼Œä¸æ¨èä½¿ç”¨
4. è‡ªåŠ¨è£…é…ä¼˜å…ˆçº§ä½äºsetteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼ŒåŒæ—¶å‡ºç°æ—¶è‡ªåŠ¨è£…é…é…ç½®å¤±æ•ˆ



## 7 é›†åˆæ³¨å…¥

å¸¸è§çš„é›†åˆç±»å‹æœ‰ï¼š

- æ•°ç»„
- List
- Set
- Map
- Properties

1ï¼‰public interface BookDao {
    public void save();
}

public class BookDaoImpl implements BookDao {
    
public class BookDaoImpl implements BookDao {

```java
private int[] array;

private List<String> list;

private Set<String> set;

private Map<String,String> map;

private Properties properties;

 public void save() {
    System.out.println("book dao save ...");

    System.out.println("éå†æ•°ç»„:" + Arrays.toString(array));

    System.out.println("éå†List" + list);

    System.out.println("éå†Set" + set);

    System.out.println("éå†Map" + map);

    System.out.println("éå†Properties" + properties);
}
//setter....æ–¹æ³•çœç•¥ï¼Œè‡ªå·±ä½¿ç”¨å·¥å…·ç”Ÿæˆ
```

}





(2)resourcesä¸‹æä¾›springçš„é…ç½®æ–‡ä»¶ï¼ŒapplicationContext.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="bookDao" class="com.itheima.dao.impl.BookDaoImpl"/>
</beans>
```



(3)ç¼–å†™AppForDICollectionè¿è¡Œç±»ï¼ŒåŠ è½½Springçš„IOCå®¹å™¨ï¼Œå¹¶ä»ä¸­è·å–å¯¹åº”çš„beanå¯¹è±¡

```java
public class AppForDICollection {
    public static void main( String[] args ) {
        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");
        BookDao bookDao = (BookDao) ctx.getBean("bookDao");
        bookDao.save();
    }
}
```



### æ³¨å…¥æ•°ç»„ç±»å‹æ•°æ®

```xml
<property name="array">
<array>
        <value>  100  </value>
        <value>  100  </value>
        <value>  100  </value>
    </array>
</property>
```





#### æ³¨å…¥Listç±»å‹æ•°æ®

```xml
<property name="list">
    <list>
        <value>itcast</value>
        <value>itheima</value>
        <value>boxuegu</value>
        <value>chuanzhihui</value>
    </list>
</property>
```

#### 

#### æ³¨å…¥Setç±»å‹æ•°æ®

```xml
<property name="set">
    <set>
        <value>itcast</value>
        <value>itheima</value>
        <value>boxuegu</value>
        <value>boxuegu</value>
    </set>
</property>
```

#### 

#### æ³¨å…¥Mapç±»å‹æ•°æ®

```xml
<property name="map">
    <map>
        <entry key="country" value="china"/>
        <entry key="province" value="henan"/>
        <entry key="city" value="kaifeng"/>
    </map>
</property>
```

#### 

## 8 æ³¨å…¥Propertiesç±»å‹æ•°æ®



```xml
<properties name="properties">
<props>
    <prop key="country">china</prop>
        <prop key="city">beijing</prop>
    </props>
</properties>
```



è¯´æ˜;

- propertiesæ ‡ç­¾ä¸­è¡¨ç¤ºsetteræ–¹å¼æ³¨å…¥ï¼Œæ„é€ æ–¹å¼conStructor-argæ ‡ç­¾å†…éƒ¨ä¹Ÿå¯ä»¥å†™<array>ã€‚ã€‚ã€‚ã€‚
- Listçš„åº•å±‚ä¹Ÿæ˜¯ç”¨æ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥<List>å’Œ<array>æ ‡ç­¾æ˜¯å¯ä»¥æ··ç”¨çš„
- é›†åˆä¸­è¦æ·»åŠ å¼•ç”¨ç±»å‹ã€åªéœ€è¦æŠŠ<value>æ ‡ç­¾æ”¹æˆ<ref>æ ‡ç­¾ï¼Œè¿™ç§æ–¹å¼ä½¿ç”¨çš„æ¯”è¾ƒå°‘



## 9 IOC/DIé…ç½®ç®¡ç†ç¬¬ä¸‰æ–¹bean

æ•°æ®æºå¯¹è±¡ç®¡ç†



> éœ€æ±‚ï¼šä½¿ç”¨Springçš„IOCå®¹å™¨æ¥ç®¡ç†Druidè¿æ¥æ± å¯¹è±¡
>
> 1. ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æŠ€æœ¯ï¼Œéœ€è¦åœ¨pom.xmlæ·»åŠ ä¾èµ–
> 2. åœ¨é…ç½®æ–‡ä»¶ä¸­å°†ã€ç¬¬ä¸‰æ–¹çš„ç±»ã€‘åˆ¶ä½œæˆä¸€ä¸ªbeanï¼Œè®©IOCå®¹å™¨æ¥è¿›è¡Œç®¡ç†
> 3. æ•°æ®åº“è¿æ¥æ± éœ€è¦åŸºç¡€çš„å››è¦ç´  é©±åŠ¨ã€è¿æ¥ã€ç”¨æˆ·åã€å¯†ç ï¼Œã€å¦‚ä½•æ³¨å…¥ã€‘åˆ°å¯¹åº”çš„beanä¸­
> 4. ä»IOCå®¹å™¨ä¸­è·å–å¯¹åº”çš„beanå¯¹è±¡ï¼Œå°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ä¸­æŸ¥çœ‹ç»“æœ



pom.xmlä¸­æ·»åŠ ä¾èµ–

é…ç½®ç¬¬ä¸‰æ–¹çš„bean

åœ¨applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ DruidDataSourceçš„é…ç½®

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd">
	<!--ç®¡ç†DruidDataSourceå¯¹è±¡-->
    <bean class="com.alibaba.druid.pool.DruidDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost:3306/spring_db"/>
        <property name="username" value="root"/>
        <property name="password" value="root"/>
    </bean>
</beans>
```





### é…ç½®ç¬¬ä¸‰æ–¹bean

åœ¨applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ `DruidDataSource`çš„é…ç½®

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd">
	<!--ç®¡ç†DruidDataSourceå¯¹è±¡-->
    <bean class="com.alibaba.druid.pool.DruidDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost:3306/spring_db"/>
        <property name="username" value="root"/>
        <property name="password" value="root"/>
    </bean>
</beans>
```

**è¯´æ˜:**

* driverClassName:æ•°æ®åº“é©±åŠ¨
* url:æ•°æ®åº“è¿æ¥åœ°å€
* username:æ•°æ®åº“è¿æ¥ç”¨æˆ·å
* password:æ•°æ®åº“è¿æ¥å¯†ç 
* æ•°æ®åº“è¿æ¥çš„å››è¦ç´ è¦å’Œè‡ªå·±ä½¿ç”¨çš„æ•°æ®åº“ä¿¡æ¯ä¸€è‡´ã€‚

### ä»IOCå®¹å™¨ä¸­è·å–å¯¹åº”çš„beanå¯¹è±¡

```java
public class App {
    public static void main(String[] args) {
       ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");
       DataSource dataSource = (DataSource) ctx.getBean("dataSource");
       System.out.println(dataSource);
    }
}
```

##### 



### å®ç°c3p0ç®¡ç†

é…ç½®ç¬¬ä¸‰æ–¹bean



åœ¨applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®



```xml
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
    <property name="driverClass" value="com.mysql.jdbc.Driver"/>
    <property name="jdbcUrl" value="jdbc:mysql://localhost:3306/spring_db"/>
    <property name="user" value="root"/>
    <property name="password" value="root"/>
    <property name="maxPoolSize" value="1000"/>
</bean>
```



- ComboPooleDataSourceçš„å±æ€§æ˜¯é€šè¿‡setteræ–¹å¼æ³¨å…¥
- æƒ³æ³¨å…¥çš„å±æ€§å°±éœ€è¦åœ¨ComboPooleDataSourceç±»æˆ–è€…æ˜¯ä¸Šå±‚ç±»ä¸­æä¾›å±æ€§å¯¹åº”çš„setteræ–¹æ³•
- C3P0çš„å››ä¸ªå±æ€§å’ŒDruidçš„å››ä¸ªå±æ€§æ˜¯ä¸ä¸€æ ·çš„



æ³¨æ„ï¼š

- æ•°æ®è¿æ¥æ± åœ¨é…ç½®å±æ€§çš„æ—¶å€™ï¼Œé™¤äº†å¯ä»¥æ³¨å…¥æ•°æ®åº“è¿æ¥å››ä¸ªè¦ç´ ä¹‹å¤–è¿˜å¯ä»¥é…ç½®å¾ˆå¤šå…¶ä»–çš„å±æ€§ï¼Œå…·ä½“éƒ½æœ‰å“ªäº›å±æ€§éœ€è¦è‡ªå·±å»æŸ¥
  - Druidå’ŒC3P0åœ¨æ²¡æœ‰å¯¼å…¥mysqlé©±åŠ¨åŒ…çš„å‰æä¹‹ä¸‹ï¼Œä¸€ä¸ªæŠ¥é”™ä¸€ä¸ªæ²¡æŠ¥é”™ï¼Œè¯´æ˜Druidåœ¨åˆå§‹åŒ–çš„æ—¶å€™æ²¡æœ‰åŠ è½½é©±åŠ¨ï¼Œè€ŒC3P0åˆšå¥½ç›¸å
  - Druidç¨‹åºè¿è¡Œè™½ç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯å½“è°ƒç”¨DruidDataSourceçš„getConnection()æ–¹æ³•è·å–é“¾æ¥çš„æ—¶å€™ï¼Œä¹Ÿä¼šæ‰¾ä¸åˆ°é©±åŠ¨ç±»çš„é”™è¯¯



### åŠ è½½propertiesé…ç½®æ–‡ä»¶

åŒ…å«äº†ä¸€äº›é—®é¢˜

- è¿™ä¸¤ä¸ªæ•°æ®æºä¸­éƒ½ä½¿ç”¨åˆ°äº†ä¸€äº›å›ºå®šçš„å¸¸é‡å¦‚æ•°æ®åº“è¿æ¥å››ä¸ªè¦ç´ ï¼ŒæŠŠè¿™äº›å€¼å†™åœ¨Springçš„é…ç½®æ–‡ä»¶ä¸­ä¸åˆ©äºåæœŸçš„ç»´æŠ¤

- éœ€è¦å°†è¿™äº›å€¼æå–åˆ°ä¸€ä¸ªå¤–éƒ¨çš„propertiesé…ç½®æ–‡ä»¶ä¸­
- Springæ¡†æ¶ä¸­å¦‚ä½•ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å±æ€§å€¼æ¥é…ç½®å°±æ˜¯æ¥ä¸‹æ¥çš„é—®é¢˜



ç¬¬ä¸‰æ–¹beanå±æ€§ä¼˜åŒ–

##### å®ç°æ€è·¯

> éœ€æ±‚:å°†æ•°æ®åº“è¿æ¥å››è¦ç´ æå–åˆ°propertiesé…ç½®æ–‡ä»¶ï¼Œspringæ¥åŠ è½½é…ç½®ä¿¡æ¯å¹¶ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å®Œæˆå±æ€§æ³¨å…¥ã€‚
>
> 1.åœ¨resourcesä¸‹åˆ›å»ºä¸€ä¸ªjdbc.properties(æ–‡ä»¶çš„åç§°å¯ä»¥ä»»æ„)
>
> 2.å°†æ•°æ®åº“è¿æ¥å››è¦ç´ é…ç½®åˆ°é…ç½®æ–‡ä»¶ä¸­
>
> 3.åœ¨Springçš„é…ç½®æ–‡ä»¶ä¸­åŠ è½½propertiesæ–‡ä»¶
>
> 4.ä½¿ç”¨åŠ è½½åˆ°çš„å€¼å®ç°å±æ€§æ³¨å…¥
>
> å…¶ä¸­ç¬¬3ï¼Œ4æ­¥éª¤æ˜¯é‡ç‚¹å…³æ³¨çš„ï¼Œå…·ä½“æ˜¯å¦‚ä½•å®ç°ã€‚

##### å®ç°æ­¥éª¤

å‡†å¤‡å¥½propertiesé…ç½®æ–‡ä»¶

resourceä¸‹åˆ›å»ºä¸€ä¸ªjdbc.propertiesæ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¯¹åº”çš„å±æ€§é”®å€¼å¯¹

```
jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://127.0.0.1:3306/Database_name
jdbc.username=root
jdbc.password=root
```

åœ¨applicationContext.xmlä¸­å¼€contextå‘½åç©ºé—´

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context.xsd">         
</beans>
```



ä½¿ç”¨${key}æ¥è¯»å–propertiesé…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å¹¶å®Œæˆå±æ€§æ³¨å…¥

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context.xsd">
    
    
    <context:property-placeholder location="jdbc.properties"/>
    <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
        <property name="driverClassName" value="${jdbc.driver}"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
    </bean>
</beans>
```



### **è¯»å–å•ä¸ªå±æ€§**



```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context.xsd">

    <bean id="bookDao" class="com.ityueheng.dao.impl.BookDaoImpl">    </bean>

    <bean id="userDao" class="com.ityueheng.User.impl.UserDaoImpl">    </bean>
    <bean id="bookService" class="com.ityueheng.service.impl.BookServiceImpl">
        <property name="bookDao" ref="bookDao"/>
        <property name="userDao" ref="userDao"/>
    </bean>

<!--    ç›´æ¥å¯¹å®ä½“ç±»Studentä¸­çš„å±æ€§èµ‹å€¼-->
    <bean id="stu" class="com.ityueheng.pojo.Student">
        <property name="age" value="28"/>
        <property name="id" value="202110098141"/>
        <property name="name" value="æ—å¸¸æ’"/>
    </bean>

    <context:property-placeholder location="jdbc.properties"/>
    <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
        <property name="driverClassName" value="${jdbc.driver}"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
    </bean>
    
    ***
    <bean id="bookDao1" class="com.ityueheng.dao.impl.BookDaoImpl">
        <property name="name" value="${jdbc.driver}"/>
    </bean>

</beans>
```



æ³¨æ„äº‹é¡¹ï¼š

- é—®é¢˜ä¸€ï¼šé”®å€¼å¯¹çš„keyä¸ºusernameå¼•å‘çš„é—®é¢˜

1. åœ¨propertiesä¸­é…ç½®é”®å€¼å¯¹çš„æ—¶å€™ï¼Œå¦‚æœkeyè®¾ç½®ä¸ºusername

```
username=root666
```

å‡ºç°é—®é¢˜çš„åŸå› æ˜¯`<context:property-placeholder/>`æ ‡ç­¾ä¼šåŠ è½½ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œè€Œä¸”ç¯å¢ƒå˜é‡çš„å€¼ä¼šè¢«ä¼˜å…ˆåŠ è½½ï¼Œå¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡?

```java
public static void main(String[] args) throws Exception{
    Map<String, String> env = System.getenv();
    System.out.println(env);
}
```



```
    <context:property-placeholder location="jdbc.properties" system-properties-mode="NEVER"/>
```

system-properties-modeï¼šè®¾ç½®ä¸ºNEVERï¼Œè¡¨ç¤ºä¸åŠ è½½ç³»ç»Ÿçš„å±æ€§ï¼Œå°±å¯ä»¥è§£å†³ä¸Šè¿°é—®é¢˜

æœ€å¥½çš„è§£å†³æ–¹æ³•å°±æ˜¯é¿å…ä½¿ç”¨usernameä½œä¸ºå±æ€§çš„key



å½“æœ‰å¤šä¸ªpropertiesé…ç½®æ–‡ä»¶éœ€è¦è¢«åŠ è½½ï¼Œè¯¥å¦‚ä½•é…ç½®?

1.è°ƒæ•´ä¸‹é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œåœ¨resourcesä¸‹æ·»åŠ `jdbc.properties`,`jdbc2.properties`,å†…å®¹å¦‚ä¸‹:

jdbc.properties

```properties
jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://127.0.0.1:3306/spring_db
jdbc.username=root
jdbc.password=root
```

jdbc2.properties

```properties
username=root666
```



```xml
æ–¹å¼ä¸€ï¼š
<context:property-placeholder location="jdbc.properties,jdbc2.properties" system-properties-mode="NEVER">
    æ–¹å¼äºŒï¼š
    <context:property-placeholder location="*.properties" system-properties-mode="NEVER">
        æ–¹å¼ä¸‰ï¼š
            <context:property-placeholder location="classpath:*.properties" system-properties-mode="NEVER">
                æ–¹å¼å››ï¼š
                      <context:property-placeholder location="classpath*:*.properties" system-properties-mode="NEVER">
```

- æ–¹å¼ä¸€ï¼šå¯ä»¥å®ç°ï¼Œå¦‚æœé…ç½®æ–‡ä»¶å¤šçš„è¯ï¼Œæ¯ä¸ªéƒ½éœ€è¦é…ç½®
- æ–¹å¼äºŒï¼š*.propertiesä»£è¡¨çš„æ˜¯æ‰€æœ‰
- æ–¹å¼ä¸‰ï¼šæ ‡å‡†å†™æ³•ï¼Œclasspathï¼šä»£è¡¨çš„æ˜¯ä»æ ¹è·¯å¾„å¼€å§‹æŸ¥æ‰¾ï¼Œä½†æ˜¯åªèƒ½æŸ¥è¯¢åˆ°å½“å‰é¡¹ç›®çš„è·¯å¾„
- æ–¹å¼å››ï¼šä¸ä»…å¯ä»¥åŠ è½½å½“å‰é¡¹ç›®è¿˜å¯ä»¥åŠ è½½å½“å‰é¡¹ç›®æ‰€ä¾èµ–çš„æ‰€æœ‰é¡¹ç›®çš„æ ¹è·¯å¾„ä¸‹çš„propertiesé…ç½®æ–‡ä»¶

































































































































![image-20221209091913181](java-SSM.assets/image-20221209091913181.png)

![image-20221209093248647](java-SSM.assets/image-20221209093248647.png)







# AOPç®€ä»‹ï¼š

Aopå°±æ˜¯åœ¨ä¸æ”¹å˜åŸæœ‰çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå¯¹å…¶è¿›è¡Œå¢å¼º

## ä»€ä¹ˆæ˜¯AOP?

* AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„ã€‚
  * OOP(Object Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹

OOPæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œé‚£ä¹ˆAOPä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œç¼–ç¨‹æ€æƒ³ä¸»è¦çš„å†…å®¹å°±æ˜¯æŒ‡å¯¼ç¨‹åºå‘˜è¯¥å¦‚ä½•ç¼–å†™ç¨‹åºï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªæ˜¯ä¸åŒçš„`ç¼–ç¨‹èŒƒå¼`ã€‚

### AOPä½œç”¨

- ä½œç”¨:åœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡ŒåŠŸèƒ½å¢å¼ºï¼Œå‰é¢å’±ä»¬æœ‰æŠ€æœ¯å°±å¯ä»¥å®ç°è¿™æ ·çš„åŠŸèƒ½å³ä»£ç†æ¨¡å¼ã€‚

å‰é¢å’±ä»¬æœ‰æŠ€æœ¯å°±å¯ä»¥å®ç°è¿™æ ·çš„åŠŸèƒ½å³`ä»£ç†æ¨¡å¼`ã€‚



```java
@Repository
public class BookDaoImpl implements BookDao {
    public void save() {
        //è®°å½•ç¨‹åºå½“å‰æ‰§è¡Œæ‰§è¡Œï¼ˆå¼€å§‹æ—¶é—´ï¼‰
        Long startTime = System.currentTimeMillis();
        //ä¸šåŠ¡æ‰§è¡Œä¸‡æ¬¡
        for (int i = 0;i<10000;i++) {
            System.out.println("book dao save ...");
        }
        //è®°å½•ç¨‹åºå½“å‰æ‰§è¡Œæ—¶é—´ï¼ˆç»“æŸæ—¶é—´ï¼‰
        Long endTime = System.currentTimeMillis();
        //è®¡ç®—æ—¶é—´å·®
        Long totalTime = endTime-startTime;
        //è¾“å‡ºä¿¡æ¯
        System.out.println("æ‰§è¡Œä¸‡æ¬¡æ¶ˆè€—æ—¶é—´ï¼š" + totalTime + "ms");
    }
    public void update(){
        System.out.println("book dao update ...");
    }
    public void delete(){
        System.out.println("book dao delete ...");
    }
    public void select(){
        System.out.println("book dao select ...");
    }
}
```

![image-20221210162709917](java-SSM.assets/image-20221210162709917.png)

è¿™æ®µä»£ç çš„å…¶ä»–æ–¹æ³•(update()ï¼Œdelete()ï¼Œselect())ä¹Ÿèƒ½å¤Ÿå¢åŠ è·Ÿsave()æ–¹æ³•ä¸€æ ·çš„åŠŸèƒ½ã€‚

åœ¨ä¸æƒŠåŠ¨(æ”¹åŠ¨)åŸæœ‰è®¾è®¡(ä»£ç )çš„å‰æä¸‹ï¼Œæƒ³ç»™è°æ·»åŠ åŠŸèƒ½å°±ç»™è°æ·»åŠ ã€‚è¿™ä¸ªä¹Ÿå°±æ˜¯Springçš„ç†å¿µï¼š

* æ— å…¥ä¾µå¼/æ— ä¾µå…¥å¼



![image-20221210162641272](java-SSM.assets/image-20221210162641272.png)



* è¿æ¥ç‚¹(JoinPoint)ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„ä½ç½®ï¼Œç²’åº¦ä¸ºæ‰§è¡Œæ–¹æ³•ã€æŠ›å‡ºå¼‚å¸¸ã€è®¾ç½®å˜é‡ç­‰
  * åœ¨SpringAOPä¸­ï¼Œç†è§£ä¸ºæ–¹æ³•çš„æ‰§è¡Œ
* åˆ‡å…¥ç‚¹(Pointcut):åŒ¹é…è¿æ¥ç‚¹çš„å¼å­
  * åœ¨SpringAOPä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹å¯ä»¥æè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä¹ŸåŒ¹é…å¤šä¸ªæ–¹æ³•
    * ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•:å¦‚com.itheima.daoåŒ…ä¸‹çš„BookDaoæ¥å£ä¸­çš„æ— å½¢å‚æ— è¿”å›å€¼çš„saveæ–¹æ³•
    * åŒ¹é…å¤šä¸ªæ–¹æ³•:æ‰€æœ‰çš„saveæ–¹æ³•ï¼Œæ‰€æœ‰çš„getå¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥Daoç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•
  * è¿æ¥ç‚¹èŒƒå›´è¦æ¯”åˆ‡å…¥ç‚¹èŒƒå›´å¤§ï¼Œæ˜¯åˆ‡å…¥ç‚¹çš„æ–¹æ³•ä¹Ÿä¸€å®šæ˜¯è¿æ¥ç‚¹ï¼Œä½†æ˜¯æ˜¯è¿æ¥ç‚¹çš„æ–¹æ³•å°±ä¸ä¸€å®šè¦è¢«å¢å¼ºï¼Œæ‰€ä»¥å¯èƒ½ä¸æ˜¯åˆ‡å…¥ç‚¹ã€‚
* é€šçŸ¥(Advice):åœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½
  * åœ¨SpringAOPä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç°
* é€šçŸ¥ç±»ï¼šå®šä¹‰é€šçŸ¥çš„ç±»
* åˆ‡é¢(Aspect):æè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ã€‚



### AOPå…¥é—¨æ¡ˆä¾‹

è®¾å®šï¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰è¾“å‡ºå½“å‰ç³»ç»Ÿæ—¶é—´ã€‚



é‡‡ç”¨æ³¨è§£å®ŒæˆAOPçš„å¼€å‘ã€‚





> 1.å¯¼å…¥åæ ‡(pom.xml)         
>
> 2.åˆ¶ä½œè¿æ¥ç‚¹(åŸå§‹æ“ä½œï¼ŒDaoæ¥å£ä¸å®ç°ç±»)
>
> 3.åˆ¶ä½œå…±æ€§åŠŸèƒ½(é€šçŸ¥ç±»ä¸é€šçŸ¥)
>
> 4.å®šä¹‰åˆ‡å…¥ç‚¹
>
> 5.ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»(åˆ‡é¢)



### 2.4 AOPå®ç°æ­¥éª¤

#### æ­¥éª¤1:æ·»åŠ ä¾èµ–

pom.xml

```xml
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjweaver</artifactId>
    <version>1.9.4</version>
</dependency>
```

![1630146885493](java-SSM.assets/1630146885493.png)

* å› ä¸º`spring-context`ä¸­å·²ç»å¯¼å…¥äº†`spring-aop`,æ‰€ä»¥ä¸éœ€è¦å†å•ç‹¬å¯¼å…¥`spring-aop`
* å¯¼å…¥AspectJçš„jaråŒ…,AspectJæ˜¯AOPæ€æƒ³çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼ŒSpringæœ‰è‡ªå·±çš„AOPå®ç°ï¼Œä½†æ˜¯ç›¸æ¯”äºAspectJæ¥è¯´æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥é‡‡ç”¨Springæ•´åˆApsectJçš„æ–¹å¼è¿›è¡ŒAOPå¼€å‘ã€‚

#### æ­¥éª¤2:å®šä¹‰æ¥å£ä¸å®ç°ç±»



#### æ­¥éª¤3:å®šä¹‰é€šçŸ¥ç±»å’Œé€šçŸ¥

é€šçŸ¥å°±æ˜¯å°†å…±æ€§åŠŸèƒ½æŠ½å–å‡ºæ¥åå½¢æˆçš„æ–¹æ³•ï¼Œå…±æ€§åŠŸèƒ½æŒ‡çš„å°±æ˜¯å½“å‰ç³»ç»Ÿæ—¶é—´çš„æ‰“å°ã€‚

```java
public class MyAdvice {
    public void method(){
        System.out.println(System.currentTimeMillis());
    }
}
```

#### æ­¥éª¤4:å®šä¹‰åˆ‡å…¥ç‚¹

BookDaoImplä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯saveå’Œupdateï¼Œæˆ‘ä»¬è¦å¢å¼ºçš„æ˜¯updateæ–¹æ³•ï¼Œè¯¥å¦‚ä½•å®šä¹‰å‘¢?

```java
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")   //å®šä¹‰é€šå¼å­
    private void pt(){}
    @Before("pt()")
    public void method(){
        System.out.println(System.currentTimeMillis());
    }
}
```

ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»ï¼Œå¹¶æŒ‡å®šé€šçŸ¥æ·»åŠ åˆ°åŸå§‹è¿æ¥ç‚¹çš„å…·ä½“æ‰§è¡Œ==ä½ç½®==

![1630148447689](java-SSM.assets/1630148447689.png)

**è¯´æ˜:**@Beforeç¿»è¯‘è¿‡æ¥æ˜¯ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯è¯´é€šçŸ¥ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ



#### æ­¥éª¤6:å°†é€šçŸ¥ç±»é…ç»™å®¹å™¨å¹¶æ ‡è¯†å…¶ä¸ºåˆ‡é¢ç±»

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Before("pt()")
    public void method(){
        System.out.println(System.currentTimeMillis());
    }
}
```

#### æ­¥éª¤7:å¼€å¯æ³¨è§£æ ¼å¼AOPåŠŸèƒ½

```java
@Configuration
@ComponentScan("com.itheima")
@EnableAspectJAutoProxy
public class SpringConfig {
}
```



### çŸ¥è¯†ç‚¹1ï¼š@EnableAspectJAutoProxy  

| åç§° | @EnableAspectJAutoProxy |
| ---- | ----------------------- |
| ç±»å‹ | é…ç½®ç±»æ³¨è§£              |
| ä½ç½® | é…ç½®ç±»å®šä¹‰ä¸Šæ–¹          |
| ä½œç”¨ | å¼€å¯æ³¨è§£æ ¼å¼AOPåŠŸèƒ½     |

### çŸ¥è¯†ç‚¹2ï¼š@Aspect

| åç§° | @Aspect               |
| ---- | --------------------- |
| ç±»å‹ | ç±»æ³¨è§£                |
| ä½ç½® | åˆ‡é¢ç±»å®šä¹‰ä¸Šæ–¹        |
| ä½œç”¨ | è®¾ç½®å½“å‰ç±»ä¸ºAOPåˆ‡é¢ç±» |

### çŸ¥è¯†ç‚¹3ï¼š@Pointcut   

| åç§° | @Pointcut                   |
| ---- | --------------------------- |
| ç±»å‹ | æ–¹æ³•æ³¨è§£                    |
| ä½ç½® | åˆ‡å…¥ç‚¹æ–¹æ³•å®šä¹‰ä¸Šæ–¹          |
| ä½œç”¨ | è®¾ç½®åˆ‡å…¥ç‚¹æ–¹æ³•              |
| å±æ€§ | valueï¼ˆé»˜è®¤ï¼‰ï¼šåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ |

### çŸ¥è¯†ç‚¹4ï¼š@Before

| åç§° | @Before                                                      |
| ---- | ------------------------------------------------------------ |
| ç±»å‹ | æ–¹æ³•æ³¨è§£                                                     |
| ä½ç½® | é€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹                                             |
| ä½œç”¨ | è®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•å‰è¿è¡Œ |



### AOPå·¥ä½œæµç¨‹

ç”±äºAOPæ˜¯åŸºäºSpringå®¹å™¨ç®¡ç†çš„beanåšçš„å¢å¼ºï¼Œæ‰€ä»¥æ•´ä¸ªå·¥ä½œè¿‡ç¨‹éœ€è¦ä»SpringåŠ è½½beanè¯´èµ·:

#### æµç¨‹1:Springå®¹å™¨å¯åŠ¨

* å®¹å™¨å¯åŠ¨å°±éœ€è¦å»åŠ è½½bean,å“ªäº›ç±»éœ€è¦è¢«åŠ è½½å‘¢?
* éœ€è¦è¢«å¢å¼ºçš„ç±»ï¼Œå¦‚:BookServiceImpl
* é€šçŸ¥ç±»ï¼Œå¦‚:MyAdvice
* æ³¨æ„æ­¤æ—¶beanå¯¹è±¡è¿˜æ²¡æœ‰åˆ›å»ºæˆåŠŸ

#### æµç¨‹2:è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹

![1630151682428](java-SSM.assets/1630151682428.png)

* ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­æœ‰ä¸¤ä¸ªåˆ‡å…¥ç‚¹çš„é…ç½®ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ª`ptx()`å¹¶æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸ä¼šè¢«è¯»å–ã€‚

#### æµç¨‹3:åˆå§‹åŒ–beanï¼Œ

åˆ¤å®šbeanå¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹

* æ³¨æ„ç¬¬1æ­¥åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œbeanå¯¹è±¡è¿˜æ²¡æœ‰è¢«åˆ›å»ºæˆåŠŸã€‚

* è¦è¢«å®ä¾‹åŒ–beanå¯¹è±¡çš„ç±»ä¸­çš„æ–¹æ³•å’Œåˆ‡å…¥ç‚¹è¿›è¡ŒåŒ¹é…

  ![1630152538083](java-SSM.assets/1630152538083.png)

  * åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºåŸå§‹å¯¹è±¡,å¦‚`UserDao`
    * åŒ¹é…å¤±è´¥è¯´æ˜ä¸éœ€è¦å¢å¼ºï¼Œç›´æ¥è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³•å³å¯ã€‚
  * åŒ¹é…æˆåŠŸï¼Œåˆ›å»ºåŸå§‹å¯¹è±¡ï¼ˆ==ç›®æ ‡å¯¹è±¡==ï¼‰çš„==ä»£ç†==å¯¹è±¡,å¦‚:`BookDao`
    * åŒ¹é…æˆåŠŸè¯´æ˜éœ€è¦å¯¹å…¶è¿›è¡Œå¢å¼º
    * å¯¹å“ªä¸ªç±»åšå¢å¼ºï¼Œè¿™ä¸ªç±»å¯¹åº”çš„å¯¹è±¡å°±å«åšç›®æ ‡å¯¹è±¡
    * å› ä¸ºè¦å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡ŒåŠŸèƒ½å¢å¼ºï¼Œè€Œé‡‡ç”¨çš„æŠ€æœ¯æ˜¯åŠ¨æ€ä»£ç†ï¼Œæ‰€ä»¥ä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡
    * æœ€ç»ˆè¿è¡Œçš„æ˜¯ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ä¼šå¯¹åŸå§‹æ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º

#### æµç¨‹4:è·å–beanæ‰§è¡Œæ–¹æ³•

* è·å–çš„beanæ˜¯åŸå§‹å¯¹è±¡æ—¶ï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ
* è·å–çš„beanæ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºçš„å†…å®¹ï¼Œå®Œæˆæ“ä½œ

#### éªŒè¯å®¹å™¨ä¸­æ˜¯å¦ä¸ºä»£ç†å¯¹è±¡

ä¸ºäº†éªŒè¯IOCå®¹å™¨ä¸­åˆ›å»ºçš„å¯¹è±¡å’Œæˆ‘ä»¬åˆšæ‰æ‰€è¯´çš„ç»“è®ºæ˜¯å¦ä¸€è‡´ï¼Œé¦–å…ˆå…ˆæŠŠç»“è®ºç†å‡ºæ¥:

* å¦‚æœç›®æ ‡å¯¹è±¡ä¸­çš„æ–¹æ³•ä¼šè¢«å¢å¼ºï¼Œé‚£ä¹ˆå®¹å™¨ä¸­å°†å­˜å…¥çš„æ˜¯ç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡
* å¦‚æœç›®æ ‡å¯¹è±¡ä¸­çš„æ–¹æ³•ä¸è¢«å¢å¼ºï¼Œé‚£ä¹ˆå®¹å™¨ä¸­å°†å­˜å…¥çš„æ˜¯ç›®æ ‡å¯¹è±¡æœ¬èº«ã€‚

##### æ­¥éª¤1:ä¿®æ”¹Appç±»,è·å–ç±»çš„ç±»å‹

```java
public class App {
    public static void main(String[] args) {
        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        System.out.println(bookDao);
        System.out.println(bookDao.getClass());
    }
}
```

##### æ­¥éª¤2:ä¿®æ”¹MyAdviceç±»ï¼Œä¸å¢å¼º

å› ä¸ºå®šä¹‰çš„åˆ‡å…¥ç‚¹ä¸­ï¼Œè¢«ä¿®æ”¹æˆ`update1`,æ‰€ä»¥BookDaoä¸­çš„updateæ–¹æ³•åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¸ä¼šè¢«å¢å¼ºï¼Œ

æ‰€ä»¥å®¹å™¨ä¸­çš„å¯¹è±¡åº”è¯¥æ˜¯ç›®æ ‡å¯¹è±¡æœ¬èº«ã€‚

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update1())")
    private void pt(){}
    
    @Before("pt()")
    public void method(){
        System.out.println(System.currentTimeMillis());
    }
}
```

##### æ­¥éª¤3:è¿è¡Œç¨‹åº

![1630154495165](java-SSM.assets/1630154495165.png)

##### æ­¥éª¤4:ä¿®æ”¹MyAdviceç±»ï¼Œå¢å¼º

å› ä¸ºå®šä¹‰çš„åˆ‡å…¥ç‚¹ä¸­ï¼Œè¢«ä¿®æ”¹æˆ`update`,æ‰€ä»¥BookDaoä¸­çš„updateæ–¹æ³•åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šè¢«å¢å¼ºï¼Œ

æ‰€ä»¥å®¹å™¨ä¸­çš„å¯¹è±¡åº”è¯¥æ˜¯ç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Before("pt()")
    public void method(){
        System.out.println(System.currentTimeMillis());
    }
}
```

##### æ­¥éª¤5:è¿è¡Œç¨‹åº

![1630154625564](java-SSM.assets/1630154625564.png)



æè¿°æ–¹å¼ä¸€ï¼šæ‰§è¡Œcom.itheima.daoåŒ…ä¸‹çš„BookDaoæ¥å£ä¸­çš„æ— å‚æ•°updateæ–¹æ³•

```java
execution(void com.itheima.dao.BookDao.update())
```

æè¿°æ–¹å¼äºŒï¼šæ‰§è¡Œcom.itheima.dao.implåŒ…ä¸‹çš„BookDaoImplç±»ä¸­çš„æ— å‚æ•°updateæ–¹æ³•

```
execution(void com.itheima.dao.impl.BookDaoImpl.update())
```

å¯¹äºåˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„è¯­æ³•ä¸º:

* åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦  è¿”å›å€¼  åŒ…å.ç±»/æ¥å£å.æ–¹æ³•å(å‚æ•°) å¼‚å¸¸åï¼‰

å¯¹äºè¿™ä¸ªæ ¼å¼ï¼Œä¸éœ€è¦ç¡¬è®°ï¼Œé€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œç†è§£å®ƒ:

```
execution(public User com.itheima.service.UserService.findById(int))
```

* executionï¼šåŠ¨ä½œå…³é”®å­—ï¼Œæè¿°åˆ‡å…¥ç‚¹çš„è¡Œä¸ºåŠ¨ä½œï¼Œä¾‹å¦‚executionè¡¨ç¤ºæ‰§è¡Œåˆ°æŒ‡å®šåˆ‡å…¥ç‚¹
* public:è®¿é—®ä¿®é¥°ç¬¦,è¿˜å¯ä»¥æ˜¯publicï¼Œprivateç­‰ï¼Œå¯ä»¥çœç•¥
* Userï¼šè¿”å›å€¼ï¼Œå†™è¿”å›å€¼ç±»å‹
* com.itheima.serviceï¼šåŒ…åï¼Œå¤šçº§åŒ…ä½¿ç”¨ç‚¹è¿æ¥
* UserService:ç±»/æ¥å£åç§°
* findByIdï¼šæ–¹æ³•å
* int:å‚æ•°ï¼Œç›´æ¥å†™å‚æ•°çš„ç±»å‹ï¼Œå¤šä¸ªç±»å‹ç”¨é€—å·éš”å¼€
* å¼‚å¸¸åï¼šæ–¹æ³•å®šä¹‰ä¸­æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¯ä»¥çœç•¥

åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å°±æ˜¯è¦æ‰¾åˆ°éœ€è¦å¢å¼ºçš„æ–¹æ³•



### è¯­æ³•æ ¼å¼å’Œé€šé…ç¬¦å·

* `*`:å•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–è€…åç¼€çš„åŒ¹é…ç¬¦å‡ºç°

  ```
  executionï¼ˆpublic * com.itheima.*.UserService.find*(*))
  ```

  åŒ¹é…com.itheimaåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­çš„UserServiceç±»æˆ–æ¥å£ä¸­æ‰€æœ‰findå¼€å¤´çš„å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•

* `..`ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œå¸¸ç”¨äºç®€åŒ–åŒ…åä¸å‚æ•°çš„ä¹¦å†™

  ```
  executionï¼ˆpublic User com..UserService.findById(..))
  ```

  åŒ¹é…comåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­çš„UserServiceç±»æˆ–æ¥å£ä¸­æ‰€æœ‰åç§°ä¸ºfindByIdçš„æ–¹æ³•

* `+`ï¼šä¸“ç”¨äºåŒ¹é…å­ç±»ç±»å‹

  ```
  execution(* *..*Service+.*(..))
  ```

  è¿™ä¸ªä½¿ç”¨ç‡è¾ƒä½ï¼Œæè¿°å­ç±»çš„ï¼Œç»§æ‰¿æœºä¼šå°±ä¸€æ¬¡ï¼Œä½¿ç”¨éƒ½å¾ˆæ…é‡ï¼Œæ‰€ä»¥å¾ˆå°‘ç”¨å®ƒã€‚*Service+ï¼Œè¡¨ç¤ºæ‰€æœ‰ä»¥Serviceç»“å°¾çš„æ¥å£çš„å­ç±»ã€‚





![1630163744963](java-SSM.assets/1630163744963.png)

```java
execution(void com.itheima.dao.BookDao.update())
åŒ¹é…æ¥å£ï¼Œèƒ½åŒ¹é…åˆ°
execution(void com.itheima.dao.impl.BookDaoImpl.update())
åŒ¹é…å®ç°ç±»ï¼Œèƒ½åŒ¹é…åˆ°
execution(* com.itheima.dao.impl.BookDaoImpl.update())
è¿”å›å€¼ä»»æ„ï¼Œèƒ½åŒ¹é…åˆ°
execution(* com.itheima.dao.impl.BookDaoImpl.update(*))
è¿”å›å€¼ä»»æ„ï¼Œä½†æ˜¯updateæ–¹æ³•å¿…é¡»è¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œæ— æ³•åŒ¹é…ï¼Œè¦æƒ³åŒ¹é…éœ€è¦åœ¨updateæ¥å£å’Œå®ç°ç±»æ·»åŠ å‚æ•°
execution(void com.*.*.*.*.update())
è¿”å›å€¼ä¸ºvoid,comåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸‰å±‚åŒ…ä¸‹çš„ä»»æ„ç±»çš„updateæ–¹æ³•ï¼ŒåŒ¹é…åˆ°çš„æ˜¯å®ç°ç±»ï¼Œèƒ½åŒ¹é…
execution(void com.*.*.*.update())
è¿”å›å€¼ä¸ºvoid,comåŒ…ä¸‹çš„ä»»æ„ä¸¤å±‚åŒ…ä¸‹çš„ä»»æ„ç±»çš„updateæ–¹æ³•ï¼ŒåŒ¹é…åˆ°çš„æ˜¯æ¥å£ï¼Œèƒ½åŒ¹é…
execution(void *..update())
è¿”å›å€¼ä¸ºvoidï¼Œæ–¹æ³•åæ˜¯updateçš„ä»»æ„åŒ…ä¸‹çš„ä»»æ„ç±»ï¼Œèƒ½åŒ¹é…
execution(* *..*(..))
åŒ¹é…é¡¹ç›®ä¸­ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•ï¼Œèƒ½åŒ¹é…ï¼Œä½†æ˜¯ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå½±å“èŒƒå›´å¹¿
execution(* *..u*(..))
åŒ¹é…é¡¹ç›®ä¸­ä»»æ„åŒ…ä»»æ„ç±»ä¸‹åªè¦ä»¥uå¼€å¤´çš„æ–¹æ³•ï¼Œupdateæ–¹æ³•èƒ½æ»¡è¶³ï¼Œèƒ½åŒ¹é…
execution(* *..*e(..))
åŒ¹é…é¡¹ç›®ä¸­ä»»æ„åŒ…ä»»æ„ç±»ä¸‹åªè¦ä»¥eç»“å°¾çš„æ–¹æ³•ï¼Œupdateå’Œsaveæ–¹æ³•èƒ½æ»¡è¶³ï¼Œèƒ½åŒ¹é…
execution(void com..*())
è¿”å›å€¼ä¸ºvoidï¼ŒcomåŒ…ä¸‹çš„ä»»æ„åŒ…ä»»æ„ç±»ä»»æ„æ–¹æ³•ï¼Œèƒ½åŒ¹é…ï¼Œ*ä»£è¡¨çš„æ˜¯æ–¹æ³•
execution(* com.itheima.*.*Service.find*(..))
å°†é¡¹ç›®ä¸­æ‰€æœ‰ä¸šåŠ¡å±‚æ–¹æ³•çš„ä»¥findå¼€å¤´çš„æ–¹æ³•åŒ¹é…
execution(* com.itheima.*.*Service.save*(..))
å°†é¡¹ç›®ä¸­æ‰€æœ‰ä¸šåŠ¡å±‚æ–¹æ³•çš„ä»¥saveå¼€å¤´çš„æ–¹æ³•åŒ¹é…
```

åé¢ä¸¤ç§æ›´ç¬¦åˆæˆ‘ä»¬å¹³å¸¸åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„ç¼–å†™è§„åˆ™



#### ä¹¦å†™æŠ€å·§

å¯¹äºåˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„ç¼–å†™å…¶å®æ˜¯å¾ˆçµæ´»çš„ï¼Œé‚£ä¹ˆåœ¨ç¼–å†™çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„æŠ€å·§è®©æˆ‘ä»¬ç”¨ç”¨:

- æ‰€æœ‰ä»£ç æŒ‰ç…§æ ‡å‡†è§„èŒƒå¼€å‘ï¼Œå¦åˆ™ä»¥ä¸‹æŠ€å·§å…¨éƒ¨å¤±æ•ˆ
- æè¿°åˆ‡å…¥ç‚¹é€š**==å¸¸æè¿°æ¥å£==**ï¼Œè€Œä¸æè¿°å®ç°ç±»,å¦‚æœæè¿°åˆ°å®ç°ç±»ï¼Œå°±å‡ºç°ç´§è€¦åˆäº†
- è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦é’ˆå¯¹æ¥å£å¼€å‘å‡é‡‡ç”¨publicæè¿°ï¼ˆ**==å¯çœç•¥è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦æè¿°==**ï¼‰
- è¿”å›å€¼ç±»å‹å¯¹äºå¢åˆ æ”¹ç±»ä½¿ç”¨ç²¾å‡†ç±»å‹åŠ é€ŸåŒ¹é…ï¼Œå¯¹äºæŸ¥è¯¢ç±»ä½¿ç”¨\*é€šé…å¿«é€Ÿæè¿°
- **==åŒ…å==**ä¹¦å†™**==å°½é‡ä¸ä½¿ç”¨..åŒ¹é…==**ï¼Œæ•ˆç‡è¿‡ä½ï¼Œå¸¸ç”¨\*åšå•ä¸ªåŒ…æè¿°åŒ¹é…ï¼Œæˆ–ç²¾å‡†åŒ¹é…
- **==æ¥å£å/ç±»å==**ä¹¦å†™åç§°ä¸æ¨¡å—ç›¸å…³çš„**==é‡‡ç”¨\*åŒ¹é…==**ï¼Œä¾‹å¦‚UserServiceä¹¦å†™æˆ\*Serviceï¼Œç»‘å®šä¸šåŠ¡å±‚æ¥å£å
- **==æ–¹æ³•å==**ä¹¦å†™ä»¥**==åŠ¨è¯==**è¿›è¡Œ**==ç²¾å‡†åŒ¹é…==**ï¼Œåè¯é‡‡ç”¨*åŒ¹é…ï¼Œä¾‹å¦‚getByIdä¹¦å†™æˆgetBy*,selectAllä¹¦å†™æˆselectAll
- å‚æ•°è§„åˆ™è¾ƒä¸ºå¤æ‚ï¼Œæ ¹æ®ä¸šåŠ¡æ–¹æ³•çµæ´»è°ƒæ•´
- é€šå¸¸**==ä¸ä½¿ç”¨å¼‚å¸¸==**ä½œä¸º**==åŒ¹é…==**è§„åˆ™



å…±æä¾›äº†5ç§é€šçŸ¥ç±»å‹:

- å‰ç½®é€šçŸ¥
- åç½®é€šçŸ¥
- **==ç¯ç»•é€šçŸ¥(é‡ç‚¹)==**
- è¿”å›åé€šçŸ¥(äº†è§£)
- æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(äº†è§£)



![1630166147697](java-SSM.assets/1630166147697.png)

(1)å‰ç½®é€šçŸ¥ï¼Œè¿½åŠ åŠŸèƒ½åˆ°æ–¹æ³•æ‰§è¡Œå‰,ç±»ä¼¼äºåœ¨ä»£ç 1æˆ–è€…ä»£ç 2æ·»åŠ å†…å®¹

(2)åç½®é€šçŸ¥,è¿½åŠ åŠŸèƒ½åˆ°æ–¹æ³•æ‰§è¡Œå,ä¸ç®¡æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œç±»ä¼¼äºåœ¨ä»£ç 5æ·»åŠ å†…å®¹

(3)è¿”å›åé€šçŸ¥,è¿½åŠ åŠŸèƒ½åˆ°æ–¹æ³•æ‰§è¡Œåï¼Œåªæœ‰æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸåæ‰è¿›è¡Œ,ç±»ä¼¼äºåœ¨ä»£ç 3æ·»åŠ å†…å®¹ï¼Œå¦‚æœæ–¹æ³•æ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè¿”å›åé€šçŸ¥å°†ä¸ä¼šè¢«æ·»åŠ 

(4)æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥,è¿½åŠ åŠŸèƒ½åˆ°æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åï¼Œåªæœ‰æ–¹æ³•æ‰§è¡Œå‡ºå¼‚å¸¸æ‰è¿›è¡Œ,ç±»ä¼¼äºåœ¨ä»£ç 4æ·»åŠ å†…å®¹ï¼Œåªæœ‰æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰ä¼šè¢«æ·»åŠ 

(5)ç¯ç»•é€šçŸ¥,ç¯ç»•é€šçŸ¥åŠŸèƒ½æ¯”è¾ƒå¼ºå¤§ï¼Œå®ƒå¯ä»¥è¿½åŠ åŠŸèƒ½åˆ°æ–¹æ³•æ‰§è¡Œçš„å‰åï¼Œè¿™ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ï¼Œå®ƒå¯ä»¥å®ç°å…¶ä»–å››ç§é€šçŸ¥ç±»å‹çš„åŠŸèƒ½



##### å‰ç½®é€šçŸ¥

ä¿®æ”¹MyAdvice,åœ¨beforeæ–¹æ³•ä¸Šæ·»åŠ `@Beforeæ³¨è§£`

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Before("pt()")
    //æ­¤å¤„ä¹Ÿå¯ä»¥å†™æˆ @Before("MyAdvice.pt()"),ä¸å»ºè®®
    public void before() {
        System.out.println("before advice ...");
    }
}
```



##### åç½®é€šçŸ¥

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Before("pt()")
    public void before() {
        System.out.println("before advice ...");
    }
    @After("pt()")
    public void after() {
        System.out.println("after advice ...");
    }
}
```



##### ç¯ç»•é€šçŸ¥

###### åŸºæœ¬ä½¿ç”¨



```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Around("pt()")
    public void around(ProceedingJoinPoint pjp) throws Throwable{
        System.out.println("around before advice ...");
        //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨
        pjp.proceed();
        System.out.println("around after advice ...");
    }
}
```

æ ‡å‡†æ ¼å¼ï¼š

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Pointcut("execution(int com.itheima.dao.BookDao.select())")
    private void pt2(){}
    
    @Around("pt2()")
    public Object aroundSelect(ProceedingJoinPoint pjp) throws Throwable {
        System.out.println("around before advice ...");
        //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨
        Object ret = pjp.proceed();
        System.out.println("around after advice ...");
        return ret;
    }
}
```



**è¯´æ˜:**

â€‹	ä¸ºä»€ä¹ˆè¿”å›çš„æ˜¯Objectè€Œä¸æ˜¯intçš„ä¸»è¦åŸå› æ˜¯Objectç±»å‹æ›´é€šç”¨ã€‚

â€‹	åœ¨ç¯ç»•é€šçŸ¥ä¸­æ˜¯å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è¿”å›å€¼å°±è¡Œä¿®æ”¹çš„ã€‚







##### è¿”å›åé€šçŸ¥

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Pointcut("execution(int com.itheima.dao.BookDao.select())")
    private void pt2(){}
    
    @AfterReturning("pt2()")
    public void afterReturning() {
        System.out.println("afterReturning advice ...");
    }
}
```



##### å¼‚å¸¸åé€šçŸ¥

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(void com.itheima.dao.BookDao.update())")
    private void pt(){}
    
    @Pointcut("execution(int com.itheima.dao.BookDao.select())")
    private void pt2(){}
    
    @AfterReturning("pt2()")
    public void afterThrowing() {
        System.out.println("afterThrowing advice ...");
    }
}
```



å› ä¸ºç¯ç»•é€šçŸ¥æ˜¯å¯ä»¥æ§åˆ¶åŸå§‹æ–¹æ³•æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æŠŠå¢å¼ºçš„ä»£ç å†™åœ¨è°ƒç”¨åŸå§‹æ–¹æ³•çš„ä¸åŒä½ç½®å°±å¯ä»¥å®ç°ä¸åŒçš„é€šçŸ¥ç±»å‹çš„åŠŸèƒ½ï¼Œå¦‚:

![1630170090945](java-SSM.assets/1630170090945.png)

##### 

#### è·å–å‚æ•°

##### éç¯ç»•é€šçŸ¥è·å–æ–¹å¼

åœ¨æ–¹æ³•ä¸Šæ·»åŠ JoinPoint,é€šè¿‡JoinPointæ¥è·å–å‚æ•°

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @Before("pt()")
    public void before(JoinPoint jp) 
        Object[] args = jp.getArgs();
        System.out.println(Arrays.toString(args));
        System.out.println("before advice ..." );
    }
	//...å…¶ä»–çš„ç•¥
}
```



![1630233291929](java-SSM.assets/1630233291929.png)

å‚æ•°çš„ä¸ªæ•°æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥ä½¿ç”¨æ•°ç»„æ›´é€šé…äº›ã€‚



##### ç¯ç»•é€šçŸ¥è·å–æ–¹å¼

ç¯ç»•é€šçŸ¥ä½¿ç”¨çš„æ˜¯ProceedingJoinPointï¼Œå› ä¸ºProceedingJoinPointæ˜¯JoinPointç±»çš„å­ç±»ï¼Œæ‰€ä»¥å¯¹äºProceedingJoinPointç±»ä¸­åº”è¯¥ä¹Ÿä¼šæœ‰å¯¹åº”çš„`getArgs()`æ–¹æ³•

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @Around("pt()")
    public Object around(ProceedingJoinPoint pjp)throws Throwable {
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        Object ret = pjp.proceed();
        return ret;
    }
	//å…¶ä»–çš„ç•¥
}
```

è¿è¡ŒAppåæŸ¥çœ‹è¿è¡Œç»“æœï¼Œè¯´æ˜ProceedingJoinPointä¹Ÿæ˜¯å¯ä»¥é€šè¿‡getArgs()è·å–å‚æ•°

![1630233974310](java-SSM.assets/1630233974310.png)



* pjp.proceed()æ–¹æ³•æ˜¯æœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯:

  ![1630234756123](java-SSM.assets/1630234756123.png)

  * è°ƒç”¨æ— å‚æ•°çš„proceedï¼Œå½“åŸå§‹æ–¹æ³•æœ‰å‚æ•°ï¼Œä¼šåœ¨è°ƒç”¨çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨ä¼ å…¥å‚æ•°

  * æ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•çš„ä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥å®ŒæˆåŠŸèƒ½

  * ä½†æ˜¯å½“éœ€è¦ä¿®æ”¹åŸå§‹æ–¹æ³•çš„å‚æ•°æ—¶ï¼Œå°±åªèƒ½é‡‡ç”¨å¸¦æœ‰å‚æ•°çš„æ–¹æ³•,å¦‚ä¸‹:

    ```java
    @Component
    @Aspect
    public class MyAdvice {
        @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
        private void pt(){}
    
        @Around("pt()")
        public Object around(ProceedingJoinPoint pjp) throws Throwable{
            Object[] args = pjp.getArgs();
            System.out.println(Arrays.toString(args));
            args[0] = 666;
            Object ret = pjp.proceed(args);
            return ret;
        }
    	//å…¶ä»–çš„ç•¥
    }
    ```

    æœ‰äº†è¿™ä¸ªç‰¹æ€§åï¼Œå°±å¯ä»¥åœ¨ç¯ç»•é€šçŸ¥ä¸­å¯¹åŸå§‹æ–¹æ³•çš„å‚æ•°è¿›è¡Œæ‹¦æˆªè¿‡æ»¤ï¼Œé¿å…ç”±äºå‚æ•°çš„é—®é¢˜å¯¼è‡´ç¨‹åºæ— æ³•æ­£ç¡®è¿è¡Œï¼Œä¿è¯ä»£ç çš„å¥å£®æ€§ã€‚

#### è·å–è¿”å›å€¼

å¯¹äºè¿”å›å€¼ï¼Œåªæœ‰è¿”å›å`AfterReturing`å’Œç¯ç»•`Around`è¿™ä¸¤ä¸ªé€šçŸ¥ç±»å‹å¯ä»¥è·å–ï¼Œå…·ä½“å¦‚ä½•è·å–?

##### ç¯ç»•é€šçŸ¥è·å–è¿”å›å€¼

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @Around("pt()")
    public Object around(ProceedingJoinPoint pjp) throws Throwable{
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        args[0] = 666;
        Object ret = pjp.proceed(args);
        return ret;
    }
	//å…¶ä»–çš„ç•¥
}
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œ`ret`å°±æ˜¯æ–¹æ³•çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥è·å–ï¼Œä¸ä½†å¯ä»¥è·å–ï¼Œå¦‚æœéœ€è¦è¿˜å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚



##### è¿”å›åé€šçŸ¥è·å–è¿”å›å€¼

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @AfterReturning(value = "pt()",returning = "ret")
    public void afterReturning(Object ret) {
        System.out.println("afterReturning advice ..."+ret);
    }
	//å…¶ä»–çš„ç•¥
}
```

==æ³¨æ„:==

(1)å‚æ•°åçš„é—®é¢˜

![1630237320870](java-SSM.assets/1630237320870.png)

(2)afterReturningæ–¹æ³•å‚æ•°ç±»å‹çš„é—®é¢˜

å‚æ•°ç±»å‹å¯ä»¥å†™æˆStringï¼Œä½†æ˜¯ä¸ºäº†èƒ½åŒ¹é…æ›´å¤šçš„å‚æ•°ç±»å‹ï¼Œæœ€å¥½å†™æˆObjectç±»å‹

(3)afterReturningæ–¹æ³•å‚æ•°çš„é¡ºåºé—®é¢˜

![1630237586682](java-SSM.assets/1630237586682.png)

è¿è¡ŒAppåæŸ¥çœ‹è¿è¡Œç»“æœï¼Œè¯´æ˜è¿”å›å€¼å·²ç»è¢«è·å–åˆ°

![1630237372286](java-SSM.assets/1630237372286.png)

#### 

#### è·å–å¼‚å¸¸

å¯¹äºè·å–æŠ›å‡ºçš„å¼‚å¸¸ï¼Œåªæœ‰æŠ›å‡ºå¼‚å¸¸å`AfterThrowing`å’Œç¯ç»•`Around`è¿™ä¸¤ä¸ªé€šçŸ¥ç±»å‹å¯ä»¥è·å–

##### ç¯ç»•é€šçŸ¥è·å–å¼‚å¸¸

åªéœ€è¦å°†å¼‚å¸¸æ•è·ï¼Œå°±å¯ä»¥è·å–åˆ°åŸå§‹æ–¹æ³•çš„å¼‚å¸¸ä¿¡æ¯

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @Around("pt()")
    public Object around(ProceedingJoinPoint pjp){
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        args[0] = 666;
        Object ret = null;
        try{
            ret = pjp.proceed(args);
        }catch(Throwable throwable){
            t.printStackTrace();
        }
        return ret;
    }
	//å…¶ä»–çš„ç•¥
}
```

åœ¨catchæ–¹æ³•ä¸­å°±å¯ä»¥è·å–åˆ°å¼‚å¸¸

##### æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥è·å–å¼‚å¸¸

```java
@Component
@Aspect
public class MyAdvice {
    @Pointcut("execution(* com.itheima.dao.BookDao.findName(..))")
    private void pt(){}

    @AfterThrowing(value = "pt()",throwing = "t")
    public void afterThrowing(Throwable t) {
        System.out.println("afterThrowing advice ..."+t);
    }
	//å…¶ä»–çš„ç•¥
}
```

è®©åŸå§‹æ–¹æ³•æŠ›å‡ºå¼‚å¸¸

```java
@Repository
public class BookDaoImpl implements BookDao {

    public String findName(int id,String password) {
        System.out.println("id:"+id);
        if(true){
            throw new NullPointerException();
        }
        return "itcast";
    }
}
```

==æ³¨æ„:==

![1630239939043](java-SSM.assets/1630239939043.png)

å¼‚å¸¸ä¿¡æ¯

![1630239997560](java-SSM.assets/1630239997560.png)







## ç™¾åº¦ç½‘ç›˜å¯†ç æ•°æ®å…¼å®¹å¤„ç†

#### éœ€æ±‚åˆ†æ

éœ€æ±‚: å¯¹ç™¾åº¦ç½‘ç›˜åˆ†äº«é“¾æ¥è¾“å…¥å¯†ç æ—¶å°¾éƒ¨å¤šè¾“å…¥çš„ç©ºæ ¼åšå…¼å®¹å¤„ç†ã€‚

![1630240203033](java-SSM.assets/1630240203033.png)

é—®é¢˜æè¿°:

* ç‚¹å‡»é“¾æ¥ï¼Œä¼šæç¤ºï¼Œè¯·è¾“å…¥æå–ç 

  ![1630240528228](java-SSM.assets/1630240528228.png)



#### å…·ä½“å®ç°

##### æ­¥éª¤1:å¼€å¯SpringAOPçš„æ³¨è§£åŠŸèƒ½

```java
@Configuration
@ComponentScan("com.ityueheng")
@EnableAspectJAutoProxy
public class SpringConfig {
}
```

##### æ­¥éª¤2:ç¼–å†™é€šçŸ¥ç±»

```java
@Component
@Aspect
public class DataAdvice {
    @Pointcut("execution(boolean com.ityueheng.service.*Service.*(*,*))")
    private void servicePt(){}
    
}
```

##### æ­¥éª¤3:æ·»åŠ ç¯ç»•é€šçŸ¥

```java
@Component
@Aspect
public class DataAdvice {
    @Pointcut("execution(boolean com.ityueheng.service.*Service.*(*,*))")
    private void servicePt(){}
    
    @Around("DataAdvice.servicePt()")
    // @Around("servicePt()")è¿™ä¸¤ç§å†™æ³•éƒ½å¯¹
    public Object trimStr(ProceedingJoinPoint pjp) throws Throwable {
        Object ret = pjp.proceed();
        return ret;
    }
    
}
```

##### æ­¥éª¤4:å®Œæˆæ ¸å¿ƒä¸šåŠ¡ï¼Œå¤„ç†å‚æ•°ä¸­çš„ç©ºæ ¼

```java
@Component
@Aspect
public class DataAdvice {
    @Pointcut("execution(boolean com.ityueheng.service.*Service.*(*,*))")
    private void servicePt(){}
    
    @Around("DataAdvice.servicePt()")
    // @Around("servicePt()")è¿™ä¸¤ç§å†™æ³•éƒ½å¯¹
    public Object trimStr(ProceedingJoinPoint pjp) throws Throwable {
        //è·å–åŸå§‹æ–¹æ³•çš„å‚æ•°
        Object[] args = pjp.getArgs();
        for (int i = 0; i < args.length; i++) {
            //åˆ¤æ–­å‚æ•°æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²
            if(args[i].getClass().equals(String.class)){
                args[i] = args[i].toString().trim();
            }
        }
        //å°†ä¿®æ”¹åçš„å‚æ•°ä¼ å…¥åˆ°åŸå§‹æ–¹æ³•çš„æ‰§è¡Œä¸­
        Object ret = pjp.proceed(args);
        return ret;
    }
    
}
```

##### æ­¥éª¤5:è¿è¡Œç¨‹åº

ä¸ç®¡å¯†ç `root`å‰åæ˜¯å¦åŠ ç©ºæ ¼ï¼Œæœ€ç»ˆæ§åˆ¶å°æ‰“å°çš„éƒ½æ˜¯true

##### æ­¥éª¤6:ä¼˜åŒ–æµ‹è¯•

ä¸ºäº†èƒ½æ›´å¥½çš„çœ‹å‡ºAOPå·²ç»ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ResourcesImplç±»ï¼Œåœ¨æ–¹æ³•ä¸­å°†å¯†ç çš„é•¿åº¦è¿›è¡Œæ‰“å°

```java
@Repository
public class ResourcesDaoImpl implements ResourcesDao {
    public boolean readResources(String url, String password) {
        System.out.println(password.length());
        //æ¨¡æ‹Ÿæ ¡éªŒ
        return password.equals("root");
    }
}
```

å†æ¬¡è¿è¡ŒæˆåŠŸï¼Œå°±å¯ä»¥æ ¹æ®æœ€ç»ˆæ‰“å°çš„é•¿åº¦æ¥çœ‹çœ‹ï¼Œå­—ç¬¦ä¸²çš„ç©ºæ ¼æœ‰æ²¡æœ‰è¢«å»é™¤æ‰ã€‚

**æ³¨æ„ï¼š**

![1630242491831](java-SSM.assets/1630242491831.png)

## 

## AOPæ€»ç»“

### AOPçš„æ ¸å¿ƒæ¦‚å¿µï¼š

æ¦‚å¿µï¼šAOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼

ä½œç”¨ï¼šå°±æ˜¯åœ¨ä¸æƒŠåŠ¨åŸå§‹ä»£ç çš„æƒ…å†µä¸‹ä¸ºæ–¹æ³•å¢åŠ åŠŸèƒ½

æ ¸å¿ƒæ¦‚å¿µ

- ä»£ç†ï¼ˆproxyï¼‰:SpringAOPçš„æ ¸å¿ƒæœ¬è´¨å°±æ˜¯é‡‡ç”¨ä»£ç†æ¨¡å¼æ¥å®ç°çš„
- è¿æ¥ç‚¹(JoinPoint)ï¼šåœ¨springAOPä¸­ï¼Œç†è§£ä¸ºä»»æ„æ–¹æ³•çš„æ‰§è¡Œ
- åˆ‡å…¥ç‚¹(Poincut)ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­ï¼Œä¹Ÿæ˜¯å…·æœ‰å…±æ€§åŠŸèƒ½çš„æ–¹æ³•æè¿°
- é€šçŸ¥(Advice)ï¼šè‹¥å¹²ä¸ªæ–¹æ³•çš„å…±æ€§åŠŸèƒ½ï¼Œåœ¨åˆ‡å…¥ç‚¹æ‰§è¡Œï¼Œæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•
- åˆ‡é¢(Aspect):æè¿°åˆ‡å…¥ç‚¹å’Œé€šçŸ¥çš„å¯¹åº”å…³ç³»
- ç›®æ ‡å¯¹è±¡(Target)ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡æˆä¸ºç›®æ ‡å¯¹è±¡



### åˆ‡å…¥ç‚¹è¡¨è¾¾å¼

- åˆ‡å…¥ç‚¹æ ‡å‡†è¡¨è¾¾å¼æ ¼å¼:åŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ åŒ…å.ç±»/æ¥å£å.æ–¹æ³•åï¼ˆå‚æ•°ï¼‰å¼‚å¸¸å)

```
execution(* com.itheima.service.*service.*(..))
```

åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°é€šé…ç¬¦ï¼š

- ä½œç”¨ï¼šç”¨äºå¿«é€Ÿæè¿°ï¼ŒèŒƒå›´æè¿°
- *:åŒ¹é…ä»»æ„çš„ç¬¦å·ï¼ˆå¸¸ç”¨ï¼‰
- ..ï¼šåŒ¹é…å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·(å¸¸ç”¨)
- +:åŒ¹é…å­ç±»ç±»å‹



åˆ‡å…¥ç‚¹è¡¨è¾¾æ˜¯ä¹¦å†™æŠ€å·§

1. æŒ‰ç…§æ ‡å‡†çš„è§„èŒƒå¼€å‘
2. æŸ¥è¯¢æ“ä½œçš„è¿”å›å€¼å»ºè®®ä½¿ç”¨*åŒ¹é…
3. å‡å°‘é€‚ç”¨..çš„å½¢å¼æè¿°åŒ…
4. å¯¹æ¥å£è¿›è¡Œæè¿°ï¼Œä½¿ç”¨è¡¨ç¤ºæ¨¡å—åç§°ï¼Œä¾‹å¦‚UserServiceçš„åŒ¹é…æè¿°ä¸º*Service
5. æ–¹æ³•åä¹¦å†™ä¿ç•™åŠ¨è¯ï¼Œä¾‹å¦‚getï¼Œä½¿ç”¨*è¡¨ç¤ºåè¯ï¼Œä¾‹å¦‚getByIdåŒ¹é…æè¿°ä¸ºgetBy*
6. å‚æ•°æ ¹æ®å®é™…æƒ…å†µçµæ´»è¿›è¡Œè°ƒæ•´



### äº”ç§é€šçŸ¥ç±»å‹

- å‰ç½®é€šçŸ¥
- åç½®é€šçŸ¥
- ç¯ç»•é€šçŸ¥(é‡ç‚¹)
  - ç¯ç»•é€šçŸ¥ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨
  - ç¯ç»•é€šçŸ¥å¯ä»¥éš”ç¦»åŸå§‹æ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œ
  - ç¯ç»•é€šçŸ¥è¿”å›å€¼è®¾ç½®ä¸ºObjectç±»å‹
  - ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç†
- è¿”å›åé€šçŸ¥
- æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥



### é€šçŸ¥ä¸­è·å–å‚æ•°

- è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•°ï¼Œæ‰€æœ‰çš„é€šçŸ¥ç±»å‹éƒ½å¯ä»¥è·å–å‚æ•°

JoinPoint:é€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥

proceedingJoinPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥

- è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ï¼Œå‰ç½®å’ŒæŠ›å‡ºå¼‚å¸¸åé€šçŸ¥æ˜¯æ²¡æœ‰è¿”å›å€¼ï¼Œåç½®é€šçŸ¥å¯æœ‰å¯æ— ï¼Œæ‰€ä»¥ä¸åšç ”ç©¶
  - è¿”å›åé€šçŸ¥
  - ç¯ç»•é€šçŸ¥
- è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ï¼Œå‰ç½®å’Œè¿”å›åé€šçŸ¥æ˜¯ä¸ä¼šæœ‰ï¼Œåç½®é€šçŸ¥å¯æœ‰å¯æ— ï¼Œæ‰€ä»¥ä¸åšç ”ç©¶
  - æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥
  - ç¯ç»•é€šçŸ¥

## 



## AOPäº‹åŠ¡ç®¡ç†



















